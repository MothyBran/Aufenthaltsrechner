<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Schengen & Visa Aufenthaltsrechner</title>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8284978389895352"
         crossorigin="anonymous"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
            font-weight: 300;
        }

        .header p {
            opacity: 0.9;
            font-size: 1.1rem;
        }

        .controls {
            background: #f8f9fa;
            padding: 20px 30px;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }

        .language-selector {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .language-btn {
            padding: 8px 16px;
            border: 2px solid #4facfe;
            background: white;
            color: #4facfe;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .language-btn.active {
            background: #4facfe;
            color: white;
        }

        .mode-switch {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .switch {
            position: relative;
            width: 60px;
            height: 30px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 30px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: #4facfe;
        }

        input:checked + .slider:before {
            transform: translateX(30px);
        }

        .mode-labels {
            display: flex;
            align-items: center;
            gap: 15px;
            font-weight: 600;
            color: #495057;
        }

        .period-display {
            background: linear-gradient(135deg, #e8f4fd 0%, #f0f9ff 100%);
            border-top: 1px solid #e3f2fd;
            border-bottom: 1px solid #e3f2fd;
            padding: 20px 30px;
        }

        .period-content {
            max-width: 900px;
            margin: 0 auto;
            text-align: center;
        }

        .period-content h3 {
            color: #1565c0;
            font-size: 1.1rem;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .period-dates {
            font-size: 1.3rem;
            font-weight: 700;
            color: #0d47a1;
            margin-bottom: 8px;
            font-family: 'Courier New', monospace;
        }

        .period-note {
            color: #1976d2;
            font-size: 0.9rem;
            font-style: italic;
            opacity: 0.8;
        }

        .content {
            padding: 30px;
        }

        .mode-section {
            display: none;
        }

        .mode-section.active {
            display: block;
        }

        .info-box {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 15px;
            margin-bottom: 30px;
            border-radius: 5px;
        }

        .info-box h3 {
            color: #1976d2;
            margin-bottom: 8px;
        }

        .info-box p {
            color: #424242;
            line-height: 1.5;
        }

        .visa-config {
            background: #fff3e0;
            border: 2px solid #ff9800;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 30px;
        }

        .visa-config h3 {
            color: #e65100;
            margin-bottom: 15px;
        }

        .visa-inputs {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .stay-entry {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }

        .stay-entry:hover {
            border-color: #4facfe;
            box-shadow: 0 5px 15px rgba(79, 172, 254, 0.1);
        }

        .stay-entry h3 {
            color: #495057;
            margin-bottom: 15px;
            font-size: 1.1rem;
        }

        .stay-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .stay-header h3 {
            margin: 0;
            color: #495057;
            font-size: 1.1rem;
        }

        .delete-stay-btn {
            background: #dc3545;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
            box-shadow: 0 2px 5px rgba(220, 53, 69, 0.3);
            min-width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .delete-stay-btn:hover {
            background: #c82333;
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(220, 53, 69, 0.4);
        }

        .entries-section, .exits-section {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .entries-section h3, .exits-section h3 {
            color: #495057;
            margin-bottom: 15px;
            font-size: 1.1rem;
        }

        .entries-grid, .exits-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
        }

        .entry-item, .exit-item {
            background: white;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            padding: 15px;
            transition: all 0.3s ease;
        }

        .entry-item:hover, .exit-item:hover {
            border-color: #4facfe;
            box-shadow: 0 3px 10px rgba(79, 172, 254, 0.1);
        }

        .entry-header, .exit-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .entry-header label, .exit-header label {
            font-weight: 600;
            color: #495057;
            font-size: 0.9rem;
        }

        .delete-entry-btn, .delete-exit-btn {
            background: #dc3545;
            color: white;
            border: none;
            padding: 4px 8px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.3s ease;
            min-width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .delete-entry-btn:hover, .delete-exit-btn:hover {
            background: #c82333;
            transform: scale(1.1);
        }

        .entry-item input, .exit-item input {
            width: 100%;
            padding: 8px;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            font-size: 0.9rem;
        }

        .entry-item input:focus, .exit-item input:focus {
            outline: none;
            border-color: #4facfe;
            box-shadow: 0 0 0 2px rgba(79, 172, 254, 0.1);
        }

        .add-entry-section, .add-exit-section {
            display: flex;
            justify-content: center;
            align-items: center;
            grid-column: 1 / -1;
        }

        .add-entry-btn, .add-exit-btn {
            background: linear-gradient(135deg, #6c757d 0%, #495057 100%);
            color: white;
            border: 2px dashed #dee2e6;
            padding: 10px 20px;
            font-size: 0.9rem;
            font-weight: 600;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .add-entry-btn:hover, .add-exit-btn:hover {
            background: linear-gradient(135deg, #495057 0%, #343a40 100%);
            border-color: #4facfe;
            transform: translateY(-2px);
        }

        .calculated-stays-container {
            margin-top: 30px;
        }

        .calculated-stays {
            background: #e8f5e8;
            border: 2px solid #28a745;
            border-radius: 12px;
            padding: 20px;
        }

        .calculated-stays h3 {
            color: #155724;
            margin-bottom: 15px;
            font-size: 1.1rem;
        }

        .stays-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .calculated-stay-item {
            background: white;
            border: 1px solid #c3e6cb;
            border-radius: 8px;
            padding: 15px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .stay-number {
            background: #28a745;
            color: white;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.9rem;
        }

        .stay-details {
            flex: 1;
        }

        .stay-period {
            font-weight: 600;
            color: #495057;
            margin-bottom: 5px;
        }

        .stay-duration {
            color: #28a745;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .calculated-stays-empty {
            text-align: center;
            padding: 40px;
            color: #6c757d;
            font-style: italic;
        }

        .date-inputs {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 10px;
        }

        .input-group {
            display: flex;
            flex-direction: column;
        }

        .input-group label {
            margin-bottom: 5px;
            font-weight: 600;
            color: #555;
        }

        .input-group input, .input-group select {
            padding: 12px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .input-group input:focus, .input-group select:focus {
            outline: none;
            border-color: #4facfe;
            box-shadow: 0 0 0 3px rgba(79, 172, 254, 0.1);
        }

        .days-display {
            text-align: right;
            color: #6c757d;
            font-weight: 600;
            margin-top: 10px;
        }

        .add-stay-section {
            text-align: center;
            margin: 20px 0;
        }

        .add-stay-btn {
            background: linear-gradient(135deg, #6c757d 0%, #495057 100%);
            color: white;
            border: 2px dashed #dee2e6;
            padding: 15px 30px;
            font-size: 1rem;
            font-weight: 600;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 3px 10px rgba(108, 117, 125, 0.2);
        }

        .add-stay-btn:hover {
            background: linear-gradient(135deg, #495057 0%, #343a40 100%);
            border-color: #4facfe;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(108, 117, 125, 0.3);
        }

        .calculate-btn {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.1rem;
            font-weight: 600;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: block;
            margin: 30px auto;
            box-shadow: 0 5px 15px rgba(79, 172, 254, 0.3);
        }

        .calculate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(79, 172, 254, 0.4);
        }

        .results {
            margin-top: 30px;
            padding: 25px;
            background: #f8f9fa;
            border-radius: 12px;
            border: 2px solid #e9ecef;
        }

        .results.hidden {
            display: none;
        }

        .result-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        .result-item:last-child {
            margin-bottom: 0;
        }

        .result-label {
            font-weight: 600;
            color: #495057;
        }

        .result-value {
            font-weight: 700;
            font-size: 1.1rem;
        }

        .status-legal {
            color: #28a745;
        }

        .status-illegal {
            color: #dc3545;
        }

        .status-warning {
            color: #ffc107;
        }

        .next-entry-date {
            background: #fff3cd;
            border: 2px solid #ffeaa7;
            color: #856404;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            text-align: center;
            font-weight: 600;
        }

        .print-section {
            text-align: center;
            margin-top: 25px;
            padding-top: 20px;
            border-top: 1px solid #e9ecef;
        }

        .print-btn {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            font-size: 1rem;
            font-weight: 600;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(40, 167, 69, 0.3);
        }

        .print-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(40, 167, 69, 0.4);
        }

        .footer {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-top: 1px solid #dee2e6;
            margin-top: 40px;
        }

        .footer-content {
            padding: 40px 30px;
            max-width: 800px;
            margin: 0 auto;
            color: #495057;
            line-height: 1.6;
        }

        .footer-content h2 {
            color: #2c3e50;
            font-size: 1.5rem;
            margin-bottom: 20px;
            text-align: center;
            font-weight: 600;
        }

        .footer-content h3 {
            color: #34495e;
            font-size: 1.2rem;
            margin: 25px 0 15px 0;
            font-weight: 600;
        }

        .intro-text {
            font-size: 1.1rem;
            text-align: center;
            margin-bottom: 20px;
            color: #2c3e50;
            font-weight: 500;
        }

        .features-text {
            margin-bottom: 10px;
            font-weight: 500;
        }

        .feature-list {
            margin-bottom: 30px;
            padding-left: 20px;
        }

        .feature-list li {
            margin-bottom: 8px;
        }

        .section {
            margin-bottom: 30px;
        }

        .section ul {
            margin: 15px 0;
            padding-left: 20px;
        }

        .section ul li {
            margin-bottom: 8px;
        }

        .benefits {
            background: #e8f5e8;
            border-left: 4px solid #28a745;
            padding: 20px;
            border-radius: 8px;
            margin-top: 30px;
        }

        .benefits p {
            margin-bottom: 8px;
            font-weight: 600;
            color: #155724;
        }

        .benefits p:last-child {
            margin-bottom: 0;
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 15px;
            }

            .header {
                padding: 20px;
            }

            .header h1 {
                font-size: 1.8rem;
            }

            .content {
                padding: 20px;
            }

            .controls {
                flex-direction: column;
                align-items: stretch;
            }

            .period-display {
                padding: 15px 20px;
            }

            .period-dates {
                font-size: 1.1rem;
            }

            .mode-switch {
                justify-content: center;
            }

            .date-inputs, .visa-inputs {
                grid-template-columns: 1fr;
                gap: 10px;
            }

            .result-item {
                flex-direction: column;
                gap: 5px;
                text-align: center;
            }

            .footer-content {
                padding: 30px 20px;
            }

            .footer-content h2 {
                font-size: 1.3rem;
            }

            .footer-content h3 {
                font-size: 1.1rem;
            }

            .intro-text {
                font-size: 1rem;
            }

            .print-btn {
                padding: 10px 20px;
                font-size: 0.9rem;
            }

            .add-stay-btn {
                padding: 12px 20px;
                font-size: 0.9rem;
            }

            .delete-stay-btn {
                min-width: 35px;
                height: 35px;
                padding: 6px 8px;
                font-size: 0.9rem;
            }

            .stay-header {
                gap: 10px;
            }

            .entries-grid, .exits-grid {
                grid-template-columns: 1fr;
                gap: 10px;
            }

            .calculated-stay-item {
                flex-direction: column;
                text-align: center;
                gap: 10px;
            }

            .stay-details {
                order: 1;
            }

            .stay-number {
                order: 2;
                align-self: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 id="headerTitle">üá™üá∫ Schengen & Visa Aufenthaltsrechner</h1>
            <p id="headerSubtitle">Berechnen Sie Ihre verbleibenden Aufenthaltstage</p>
        </div>
        
        <div class="controls">
            <div class="language-selector">
                <span id="languageLabel">Sprache:</span>
                <button class="language-btn active" onclick="setLanguage('de')">üá©üá™ DE</button>
                <button class="language-btn" onclick="setLanguage('en')">üá¨üáß EN</button>
            </div>
            
            <div class="mode-switch">
                <div class="mode-labels">
                    <span id="mode1Label">Schengen 90/180</span>
                    <label class="switch">
                        <input type="checkbox" id="modeSwitch" onchange="toggleMode()">
                        <span class="slider"></span>
                    </label>
                    <span id="mode2Label">Visum-Pr√ºfung</span>
                </div>
            </div>
        </div>
        
        <div class="period-display" id="periodDisplay">
            <div class="period-content">
                <h3 id="calculationPeriodTitle">üìÖ Aktueller Berechnungszeitraum</h3>
                <div class="period-dates" id="periodDates">
                    <span id="periodStart">-</span> ‚Üí <span id="periodEnd">-</span>
                </div>
                <div class="period-note" id="periodNote">
                    Aufenthalte in diesem 180-Tage-Zeitraum werden ber√ºcksichtigt
                </div>
            </div>
        </div>
        
        <div class="content">
            <!-- Schengen Mode -->
            <div id="schengenMode" class="mode-section active">
                <div class="info-box">
                    <h3 id="schengenRuleTitle">Schengen-Regel (90/180 Tage)</h3>
                    <p id="schengenRuleText">Als Tourist d√ºrfen Sie sich maximal <strong>90 Tage</strong> innerhalb von <strong>180 aufeinanderfolgenden Tagen</strong> im Schengen-Raum aufhalten. Geben Sie Ihre bisherigen und geplanten Aufenthalte ein, um Ihre verbleibenden Tage zu berechnen.</p>
                </div>

                <div id="schengenStayEntries"></div>
                
                <button type="button" class="calculate-btn" onclick="calculateSchengen()" id="schengenCalculateBtn">
                    üìä Aufenthaltstage berechnen
                </button>
            </div>

            <!-- Visa Mode -->
            <div id="visaMode" class="mode-section">
                <div class="info-box">
                    <h3 id="visaRuleTitle">Visum-Zeitraum Pr√ºfung</h3>
                    <p id="visaRuleText">Geben Sie Ihre Visum-Details ein und pr√ºfen Sie, ob Ihre geplanten Aufenthalte innerhalb der Visum-Beschr√§nkungen liegen.</p>
                </div>

                <div class="visa-config">
                    <h3 id="visaConfigTitle">üõÇ Visum-Konfiguration</h3>
                    <div class="visa-inputs">
                        <div class="input-group">
                            <label for="visaStart" id="visaStartLabel">Visum g√ºltig ab</label>
                            <input type="date" id="visaStart" onchange="updatePeriodDisplay()">
                        </div>
                        <div class="input-group">
                            <label for="visaEnd" id="visaEndLabel">Visum g√ºltig bis</label>
                            <input type="date" id="visaEnd" onchange="updatePeriodDisplay()">
                        </div>
                        <div class="input-group">
                            <label for="allowedDays" id="allowedDaysLabel">Erlaubte Aufenthaltstage</label>
                            <input type="number" id="allowedDays" min="1" max="365" placeholder="z.B. 90">
                        </div>
                        <div class="input-group">
                            <label for="allowedEntries" id="allowedEntriesLabel">Erlaubte Einreisen</label>
                            <select id="allowedEntries">
                                <option value="1" id="singleEntry">1 (Einmalig)</option>
                                <option value="2" id="doubleEntry">2 (Zweimalig)</option>
                                <option value="multi" id="multiEntry">MULTI (Mehrfach)</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div id="visaStayEntries"></div>
                
                <button type="button" class="calculate-btn" onclick="calculateVisa()" id="visaCalculateBtn">
                    üîç Visum-Compliance pr√ºfen
                </button>
            </div>

            <div id="results" class="results hidden">
                <h3 id="resultsTitle" style="margin-bottom: 20px; color: #495057;">üîç Berechnungsergebnis</h3>
                <div id="resultsList"></div>
                <div class="print-section">
                    <button type="button" class="print-btn" onclick="printResults()" id="printBtn">
                        üìÑ <span id="printBtnText">Drucken/Exportieren</span>
                    </button>
                </div>
            </div>
        </div>
        
        <div class="footer">
            <div class="footer-content">
                <h2 id="footerTitle">üõÇ Aufenthaltsrechner f√ºr Schengen | 90 Tage in 180 Tagen + Visumspr√ºfung</h2>
                
                <p class="intro-text" id="footerIntro">
                    Mit unserem kostenlosen Aufenthaltsrechner kannst du ganz einfach pr√ºfen, wie viele Aufenthaltstage im Schengen-Raum du bereits verbraucht hast, wie viele Tage dir noch bleiben ‚Äì und ob du aktuell legal eingereist bist.
                </p>
                
                <p class="features-text" id="footerFeatures">
                    Die Berechnung ber√ºcksichtigt sowohl:
                </p>
                
                <ul class="feature-list">
                    <li><strong id="footerFeature1">die klassische 90/180-Tage-Regel</strong> (f√ºr visumfreies Reisen)</li>
                    <li><strong id="footerFeature2">als auch Aufenthaltszeiten innerhalb eines Schengen-Visums</strong> (z. B. Typ-C-Visum mit begrenztem G√ºltigkeitszeitraum)</li>
                </ul>
                
                <div class="section">
                    <h3 id="footerWhatTitle">üîç Was macht unser Aufenthaltsrechner?</h3>
                    <ul>
                        <li id="footerWhat1">Berechnet automatisch, wie viele Tage du im aktuellen 180-Tage-Zeitraum verbracht hast</li>
                        <li id="footerWhat2">Zeigt, wie viele Aufenthaltstage noch √ºbrig sind</li>
                        <li id="footerWhat3">Pr√ºft bei Bedarf auch, ob du dein Schengen-Visum korrekt nutzt</li>
                        <li id="footerWhat4">Gibt an, ab wann eine erneute legale Einreise m√∂glich ist</li>
                    </ul>
                    <p id="footerWhatNote">Du gibst einfach deine einzelnen Aufenthaltszeitr√§ume oder deinen Visumszeitraum ein ‚Äì alles andere √ºbernimmt das Tool.</p>
                </div>
                
                <div class="section">
                    <h3 id="footerWhoTitle">üë§ F√ºr wen ist der Rechner n√ºtzlich?</h3>
                    <ul>
                        <li id="footerWho1">Touristen mit visumfreier Einreise (z. B. aus UK, USA, Kanada, Australien)</li>
                        <li id="footerWho2">Visa-Inhaber, die ihre 90 Tage im Visumszeitraum einhalten m√ºssen</li>
                        <li id="footerWho3">Digitale Nomaden, Gesch√§ftsreisende, Au-Pairs</li>
                        <li id="footerWho4">Alle, die rechtssicher im Schengen-Raum reisen m√∂chten</li>
                    </ul>
                </div>
                
                <div class="benefits">
                    <p id="footerBenefit1">‚úî Die Berechnung erfolgt direkt im Browser ‚Äì keine Datenspeicherung, keine Anmeldung n√∂tig.</p>
                    <p id="footerBenefit2">‚úî Ideal zur Planung, Dokumentation oder zum Nachweis gegen√ºber Beh√∂rden.</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentLanguage = 'de';
        let currentMode = 'schengen';
        let visibleEntries = 1;
        let visibleExits = 1;
        let calculationPeriodData = null;

        const translations = {
            de: {
                headerTitle: 'üá™üá∫ Schengen & Visa Aufenthaltsrechner',
                headerSubtitle: 'Berechnen Sie Ihre verbleibenden Aufenthaltstage',
                languageLabel: 'Sprache:',
                mode1Label: 'Schengen 90/180',
                mode2Label: 'Visum-Pr√ºfung',
                schengenRuleTitle: 'Schengen-Regel (90/180 Tage)',
                schengenRuleText: 'Als Tourist d√ºrfen Sie sich maximal <strong>90 Tage</strong> innerhalb von <strong>180 aufeinanderfolgenden Tagen</strong> im Schengen-Raum aufhalten. Geben Sie Ihre bisherigen und geplanten Aufenthalte ein, um Ihre verbleibenden Tage zu berechnen.',
                visaRuleTitle: 'Visum-Zeitraum Pr√ºfung',
                visaRuleText: 'Geben Sie Ihre Visum-Details ein und pr√ºfen Sie, ob Ihre geplanten Aufenthalte innerhalb der Visum-Beschr√§nkungen liegen.',
                visaConfigTitle: 'üõÇ Visum-Konfiguration',
                visaStartLabel: 'Visum g√ºltig ab',
                visaEndLabel: 'Visum g√ºltig bis',
                allowedDaysLabel: 'Erlaubte Aufenthaltstage',
                allowedEntriesLabel: 'Erlaubte Einreisen',
                schengenCalculateBtn: 'üìä Aufenthaltstage berechnen',
                visaCalculateBtn: 'üîç Visum-Compliance pr√ºfen',
                printBtnText: 'Drucken/Exportieren',
                addStayBtn: '+ Aufenthalt hinzuf√ºgen',
                addEntryBtn: '+ Einreise hinzuf√ºgen',
                addExitBtn: '+ Ausreise hinzuf√ºgen',
                entryLabel: 'Einreise',
                exitLabel: 'Ausreise',
                entryDateLabel: 'Einreisedatum',
                exitDateLabel: 'Ausreisedatum',
                calculatedStaysTitle: 'Berechnete Aufenthaltszeiten',
                emptyStaysMessage: 'Geben Sie Ein- und Ausreisedaten ein, um Aufenthaltszeiten zu berechnen.',
                stayOverviewTitle: 'Eingegebene Aufenthalte',
                calculationPeriodTitle: 'Aktueller Berechnungszeitraum',
                calculationPeriodSchengen: 'Aufenthalte in diesem 180-Tage-Zeitraum werden ber√ºcksichtigt',
                calculationPeriodVisa: 'Bitte Visum-Daten eingeben um Zeitraum anzuzeigen',
                today: 'Heute',
                resultsTitle: 'üîç Berechnungsergebnis',
                stayLabel: 'Aufenthalt',
                arrivalLabel: 'Ankunftsdatum',
                departureLabel: 'Abreisedatum',
                daysText: 'Tag',
                daysTextPlural: 'Tage',
                usedDaysLabel: 'üìä Genutzte Aufenthaltstage (180-Tage-Zeitraum)',
                usedDaysVisaLabel: 'üìä Genutzte Aufenthaltstage (Visum-Zeitraum)',
                remainingDaysLabel: '‚è∞ Verbleibende Aufenthaltstage',
                statusLabel: '‚öñÔ∏è Aktueller Status',
                calculationDateLabel: 'üìÖ Berechnungsstichtag',
                entriesUsedLabel: 'üö™ Verwendete Einreisen',
                statusLegal: '‚úÖ Legal',
                statusExhausted: '‚ö†Ô∏è Ausgesch√∂pft (0 Tage √ºbrig)',
                statusViolation: '‚ùå √úberschreitung',
                statusVisaValid: '‚úÖ Visum-konform',
                statusVisaViolation: '‚ùå Visum-Verletzung',
                nextEntryText: 'üö™ N√§chstm√∂gliche legale Einreise:',
                errorEndDate: '‚ö†Ô∏è Enddatum muss nach Startdatum liegen',
                errorNoStays: 'Bitte geben Sie mindestens einen Aufenthaltszeitraum ein.',
                errorVisaConfig: 'Bitte f√ºllen Sie alle Visum-Felder aus.',
                errorVisaDates: 'Visum-Enddatum muss nach Startdatum liegen.',
                errorStayOutsideVisa: '‚ö†Ô∏è Aufenthalt au√üerhalb des Visum-Zeitraums',
                tooManyEntries: 'Zu viele Einreisen',
                daysOverLimit: 'Tage √ºberschritten',
                // Footer √úbersetzungen
                footerTitle: 'üõÇ Aufenthaltsrechner f√ºr Schengen | 90 Tage in 180 Tagen + Visumspr√ºfung',
                footerIntro: 'Mit unserem kostenlosen Aufenthaltsrechner kannst du ganz einfach pr√ºfen, wie viele Aufenthaltstage im Schengen-Raum du bereits verbraucht hast, wie viele Tage dir noch bleiben ‚Äì und ob du aktuell legal eingereist bist.',
                footerFeatures: 'Die Berechnung ber√ºcksichtigt sowohl:',
                footerFeature1: 'die klassische 90/180-Tage-Regel (f√ºr visumfreies Reisen)',
                footerFeature2: 'als auch Aufenthaltszeiten innerhalb eines Schengen-Visums (z. B. Typ-C-Visum mit begrenztem G√ºltigkeitszeitraum)',
                footerWhatTitle: 'üîç Was macht unser Aufenthaltsrechner?',
                footerWhat1: 'Berechnet automatisch, wie viele Tage du im aktuellen 180-Tage-Zeitraum verbracht hast',
                footerWhat2: 'Zeigt, wie viele Aufenthaltstage noch √ºbrig sind',
                footerWhat3: 'Pr√ºft bei Bedarf auch, ob du dein Schengen-Visum korrekt nutzt',
                footerWhat4: 'Gibt an, ab wann eine erneute legale Einreise m√∂glich ist',
                footerWhatNote: 'Du gibst einfach deine einzelnen Aufenthaltszeitr√§ume oder deinen Visumszeitraum ein ‚Äì alles andere √ºbernimmt das Tool.',
                footerWhoTitle: 'üë§ F√ºr wen ist der Rechner n√ºtzlich?',
                footerWho1: 'Touristen mit visumfreier Einreise (z. B. aus UK, USA, Kanada, Australien)',
                footerWho2: 'Visa-Inhaber, die ihre 90 Tage im Visumszeitraum einhalten m√ºssen',
                footerWho3: 'Digitale Nomaden, Gesch√§ftsreisende, Au-Pairs',
                footerWho4: 'Alle, die rechtssicher im Schengen-Raum reisen m√∂chten',
                footerBenefit1: '‚úî Die Berechnung erfolgt direkt im Browser ‚Äì keine Datenspeicherung, keine Anmeldung n√∂tig.',
                footerBenefit2: '‚úî Ideal zur Planung, Dokumentation oder zum Nachweis gegen√ºber Beh√∂rden.',
                violationsTitle: 'Verst√∂√üe',
                remaining: '√ºbrig',
                placeholder90: 'z.B. 90',
                singleEntry: '1 (Einmalig)',
                doubleEntry: '2 (Zweimalig)',
                multiEntry: 'MULTI (Mehrfach)',
                visaPeriodLabel: 'Visum-Zeitraum',
                createdOn: 'Erstellt am',
                pageInfo: 'Seite 1 von 1',
                createdWith: 'Erstellt mit: Schengen Aufenthaltsrechner',
                disclaimer: 'Hinweis: Diese Berechnung dient zur Orientierung. Bei rechtlichen Fragen wenden Sie sich an die zust√§ndigen Beh√∂rden.'
            },
            en: {
                headerTitle: 'üá™üá∫ Schengen & Visa Stay Calculator',
                headerSubtitle: 'Calculate your remaining stay days',
                languageLabel: 'Language:',
                mode1Label: 'Schengen 90/180',
                mode2Label: 'Visa Check',
                schengenRuleTitle: 'Schengen Rule (90/180 days)',
                schengenRuleText: 'As a tourist, you may stay a maximum of <strong>90 days</strong> within <strong>180 consecutive days</strong> in the Schengen area. Enter your previous and planned stays to calculate your remaining days.',
                visaRuleTitle: 'Visa Period Check',
                visaRuleText: 'Enter your visa details and check if your planned stays are within the visa restrictions.',
                visaConfigTitle: 'üõÇ Visa Configuration',
                visaStartLabel: 'Visa valid from',
                visaEndLabel: 'Visa valid until',
                allowedDaysLabel: 'Allowed stay days',
                allowedEntriesLabel: 'Allowed entries',
                schengenCalculateBtn: 'üìä Calculate stay days',
                visaCalculateBtn: 'üîç Check visa compliance',
                printBtnText: 'Print/Export',
                addStayBtn: '+ Add stay',
                addEntryBtn: '+ Add entry',
                addExitBtn: '+ Add exit',
                entryLabel: 'Entry',
                exitLabel: 'Exit',
                entryDateLabel: 'Entry date',
                exitDateLabel: 'Exit date',
                calculatedStaysTitle: 'Calculated stay periods',
                emptyStaysMessage: 'Enter entry and exit dates to calculate stay periods.',
                stayOverviewTitle: 'Entered stays',
                calculationPeriodTitle: 'Current calculation period',
                calculationPeriodSchengen: 'Stays within this 180-day period are considered',
                calculationPeriodVisa: 'Please enter visa data to display period',
                today: 'Today',
                resultsTitle: 'üîç Calculation Result',
                stayLabel: 'Stay',
                arrivalLabel: 'Arrival date',
                departureLabel: 'Departure date',
                daysText: 'day',
                daysTextPlural: 'days',
                usedDaysLabel: 'üìä Used stay days (180-day period)',
                usedDaysVisaLabel: 'üìä Used stay days (visa period)',
                remainingDaysLabel: '‚è∞ Remaining stay days',
                statusLabel: '‚öñÔ∏è Current status',
                calculationDateLabel: 'üìÖ Calculation date',
                entriesUsedLabel: 'üö™ Entries used',
                statusLegal: '‚úÖ Legal',
                statusExhausted: '‚ö†Ô∏è Exhausted (0 days left)',
                statusViolation: '‚ùå Violation',
                statusVisaValid: '‚úÖ Visa compliant',
                statusVisaViolation: '‚ùå Visa violation',
                nextEntryText: 'üö™ Next possible legal entry:',
                errorEndDate: '‚ö†Ô∏è End date must be after start date',
                errorNoStays: 'Please enter at least one stay period.',
                errorVisaConfig: 'Please fill in all visa fields.',
                errorVisaDates: 'Visa end date must be after start date.',
                errorStayOutsideVisa: '‚ö†Ô∏è Stay outside visa period',
                tooManyEntries: 'Too many entries',
                daysOverLimit: 'Days exceeded',
                // Footer Translations
                footerTitle: 'üõÇ Schengen Stay Calculator | 90 days in 180 days + Visa Check',
                footerIntro: 'With our free stay calculator, you can easily check how many stay days in the Schengen area you have already used, how many days you have left ‚Äì and whether you are currently legally entered.',
                footerFeatures: 'The calculation considers both:',
                footerFeature1: 'the classic 90/180-day rule (for visa-free travel)',
                footerFeature2: 'as well as stays within a Schengen visa (e.g. Type C visa with limited validity period)',
                footerWhatTitle: 'üîç What does our stay calculator do?',
                footerWhat1: 'Automatically calculates how many days you have spent in the current 180-day period',
                footerWhat2: 'Shows how many stay days are left',
                footerWhat3: 'Also checks whether you are using your Schengen visa correctly if needed',
                footerWhat4: 'Indicates when a legal re-entry is possible again',
                footerWhatNote: 'You simply enter your individual stay periods or your visa period ‚Äì the tool takes care of everything else.',
                footerWhoTitle: 'üë§ Who is the calculator useful for?',
                footerWho1: 'Tourists with visa-free entry (e.g. from UK, USA, Canada, Australia)',
                footerWho2: 'Visa holders who must comply with their 90 days within the visa period',
                footerWho3: 'Digital nomads, business travelers, au pairs',
                footerWho4: 'Anyone who wants to travel legally in the Schengen area',
                footerBenefit1: '‚úî The calculation is done directly in the browser ‚Äì no data storage, no registration required.',
                footerBenefit2: '‚úî Ideal for planning, documentation or proof to authorities.',
                violationsTitle: 'Violations',
                remaining: 'left',
                placeholder90: 'e.g. 90',
                singleEntry: '1 (Single)',
                doubleEntry: '2 (Double)',
                multiEntry: 'MULTI (Multiple)',
                visaPeriodLabel: 'Visa Period',
                createdOn: 'Created on',
                pageInfo: 'Page 1 of 1',
                createdWith: 'Created with: Schengen Stay Calculator',
                disclaimer: 'Note: This calculation is for guidance only. For legal questions, contact the relevant authorities.'
            }
        };

        function setLanguage(lang) {
            currentLanguage = lang;
            
            document.querySelectorAll('.language-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            for (const [key, value] of Object.entries(translations[lang])) {
                const element = document.getElementById(key);
                if (element) {
                    element.innerHTML = value;
                }
            }
            
            // Platzhalter und Select-Optionen √ºbersetzen
            const allowedDaysInput = document.getElementById('allowedDays');
            if (allowedDaysInput) {
                allowedDaysInput.placeholder = translations[lang].placeholder90;
            }
            
            const singleEntry = document.getElementById('singleEntry');
            const doubleEntry = document.getElementById('doubleEntry');
            const multiEntry = document.getElementById('multiEntry');
            
            if (singleEntry) singleEntry.textContent = translations[lang].singleEntry;
            if (doubleEntry) doubleEntry.textContent = translations[lang].doubleEntry;
            if (multiEntry) multiEntry.textContent = translations[lang].multiEntry;
            
            generateStayEntries();
            updatePeriodDisplay();
        }

        function updatePeriodDisplay() {
            const periodStart = document.getElementById('periodStart');
            const periodEnd = document.getElementById('periodEnd');
            const periodNote = document.getElementById('periodNote');
            
            if (currentMode === 'schengen') {
                const today = new Date();
                const period180Start = new Date(today);
                period180Start.setDate(period180Start.getDate() - 180);
                
                periodStart.textContent = period180Start.toLocaleDateString(currentLanguage === 'de' ? 'de-DE' : 'en-GB');
                periodEnd.textContent = today.toLocaleDateString(currentLanguage === 'de' ? 'de-DE' : 'en-GB') + ` (${translations[currentLanguage].today})`;
                periodNote.textContent = translations[currentLanguage].calculationPeriodSchengen;
            } else {
                const visaStart = document.getElementById('visaStart')?.value;
                const visaEnd = document.getElementById('visaEnd')?.value;
                
                if (visaStart && visaEnd) {
                    const startDate = new Date(visaStart);
                    const endDate = new Date(visaEnd);
                    
                    periodStart.textContent = startDate.toLocaleDateString(currentLanguage === 'de' ? 'de-DE' : 'en-GB');
                    periodEnd.textContent = endDate.toLocaleDateString(currentLanguage === 'de' ? 'de-DE' : 'en-GB');
                    periodNote.textContent = currentLanguage === 'de' ? 'Alle Aufenthalte m√ºssen innerhalb dieses Visum-Zeitraums liegen' : 'All stays must be within this visa period';
                } else {
                    periodStart.textContent = '-';
                    periodEnd.textContent = '-';
                    periodNote.textContent = translations[currentLanguage].calculationPeriodVisa;
                }
            }
        }

        function toggleMode() {
            const modeSwitch = document.getElementById('modeSwitch');
            const schengenMode = document.getElementById('schengenMode');
            const visaMode = document.getElementById('visaMode');
            const results = document.getElementById('results');
            
            visibleEntries = 1;
            visibleExits = 1;
            
            if (modeSwitch.checked) {
                currentMode = 'visa';
                schengenMode.classList.remove('active');
                visaMode.classList.add('active');
            } else {
                currentMode = 'schengen';
                schengenMode.classList.add('active');
                visaMode.classList.remove('active');
            }
            
            results.classList.add('hidden');
            generateStayEntries();
            updatePeriodDisplay();
        }

        function saveCurrentInputs() {
            const savedData = {};
            
            // Einreisen speichern
            for (let i = 1; i <= 10; i++) {
                const entryInput = document.getElementById(`${currentMode}Entry${i}`);
                if (entryInput) {
                    savedData[`${currentMode}Entry${i}`] = entryInput.value;
                }
            }
            
            // Ausreisen speichern
            for (let i = 1; i <= 10; i++) {
                const exitInput = document.getElementById(`${currentMode}Exit${i}`);
                if (exitInput) {
                    savedData[`${currentMode}Exit${i}`] = exitInput.value;
                }
            }
            
            return savedData;
        }

        function restoreInputs(savedData) {
            for (const [id, value] of Object.entries(savedData)) {
                const input = document.getElementById(id);
                if (input && value) {
                    input.value = value;
                }
            }
            // Nach dem Wiederherstellen die Aufenthalte neu berechnen
            calculateStayPeriods();
        }

        function calculateStayPeriods() {
            const entries = [];
            const exits = [];
            
            // Alle Einreisen sammeln
            for (let i = 1; i <= 10; i++) {
                const entryInput = document.getElementById(`${currentMode}Entry${i}`);
                if (entryInput && entryInput.value) {
                    entries.push({
                        date: new Date(entryInput.value),
                        index: i
                    });
                }
            }
            
            // Alle Ausreisen sammeln
            for (let i = 1; i <= 10; i++) {
                const exitInput = document.getElementById(`${currentMode}Exit${i}`);
                if (exitInput && exitInput.value) {
                    exits.push({
                        date: new Date(exitInput.value),
                        index: i
                    });
                }
            }
            
            // Sortieren nach Datum
            entries.sort((a, b) => a.date.getTime() - b.date.getTime());
            exits.sort((a, b) => a.date.getTime() - b.date.getTime());
            
            // Aufenthaltszeiten berechnen
            const stayPeriods = [];
            const minLength = Math.min(entries.length, exits.length);
            
            for (let i = 0; i < minLength; i++) {
                const entry = entries[i];
                const exit = exits[i];
                
                if (entry.date <= exit.date) {
                    const timeDiff = exit.date.getTime() - entry.date.getTime();
                    const days = Math.ceil(timeDiff / (1000 * 3600 * 24)) + 1;
                    
                    stayPeriods.push({
                        number: i + 1,
                        entryDate: entry.date,
                        exitDate: exit.date,
                        days: days
                    });
                }
            }
            
            displayCalculatedStays(stayPeriods);
            return stayPeriods;
        }

        function displayCalculatedStays(stayPeriods) {
            >
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Schengen & Visa Aufenthaltsrechner</title>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8284978389895352"
         crossorigin="anonymous"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
            font-weight: 300;
        }

        .header p {
            opacity: 0.9;
            font-size: 1.1rem;
        }

        .controls {
            background: #f8f9fa;
            padding: 20px 30px;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }

        .language-selector {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .language-btn {
            padding: 8px 16px;
            border: 2px solid #4facfe;
            background: white;
            color: #4facfe;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .language-btn.active {
            background: #4facfe;
            color: white;
        }

        .mode-switch {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .switch {
            position: relative;
            width: 60px;
            height: 30px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 30px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: #4facfe;
        }

        input:checked + .slider:before {
            transform: translateX(30px);
        }

        .mode-labels {
            display: flex;
            align-items: center;
            gap: 15px;
            font-weight: 600;
            color: #495057;
        }

        .period-display {
            background: linear-gradient(135deg, #e8f4fd 0%, #f0f9ff 100%);
            border-top: 1px solid #e3f2fd;
            border-bottom: 1px solid #e3f2fd;
            padding: 20px 30px;
        }

        .period-content {
            max-width: 900px;
            margin: 0 auto;
            text-align: center;
        }

        .period-content h3 {
            color: #1565c0;
            font-size: 1.1rem;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .period-dates {
            font-size: 1.3rem;
            font-weight: 700;
            color: #0d47a1;
            margin-bottom: 8px;
            font-family: 'Courier New', monospace;
        }

        .period-note {
            color: #1976d2;
            font-size: 0.9rem;
            font-style: italic;
            opacity: 0.8;
        }

        .content {
            padding: 30px;
        }

        .mode-section {
            display: none;
        }

        .mode-section.active {
            display: block;
        }

        .info-box {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 15px;
            margin-bottom: 30px;
            border-radius: 5px;
        }

        .info-box h3 {
            color: #1976d2;
            margin-bottom: 8px;
        }

        .info-box p {
            color: #424242;
            line-height: 1.5;
        }

        .visa-config {
            background: #fff3e0;
            border: 2px solid #ff9800;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 30px;
        }

        .visa-config h3 {
            color: #e65100;
            margin-bottom: 15px;
        }

        .visa-inputs {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .stay-entry {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }

        .stay-entry:hover {
            border-color: #4facfe;
            box-shadow: 0 5px 15px rgba(79, 172, 254, 0.1);
        }

        .stay-entry h3 {
            color: #495057;
            margin-bottom: 15px;
            font-size: 1.1rem;
        }

        .stay-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .stay-header h3 {
            margin: 0;
            color: #495057;
            font-size: 1.1rem;
        }

        .delete-stay-btn {
            background: #dc3545;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
            box-shadow: 0 2px 5px rgba(220, 53, 69, 0.3);
            min-width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .delete-stay-btn:hover {
            background: #c82333;
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(220, 53, 69, 0.4);
        }

        .entries-section, .exits-section {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .entries-section h3, .exits-section h3 {
            color: #495057;
            margin-bottom: 15px;
            font-size: 1.1rem;
        }

        .entries-grid, .exits-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
        }

        .entry-item, .exit-item {
            background: white;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            padding: 15px;
            transition: all 0.3s ease;
        }

        .entry-item:hover, .exit-item:hover {
            border-color: #4facfe;
            box-shadow: 0 3px 10px rgba(79, 172, 254, 0.1);
        }

        .entry-header, .exit-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .entry-header label, .exit-header label {
            font-weight: 600;
            color: #495057;
            font-size: 0.9rem;
        }

        .delete-entry-btn, .delete-exit-btn {
            background: #dc3545;
            color: white;
            border: none;
            padding: 4px 8px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.3s ease;
            min-width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .delete-entry-btn:hover, .delete-exit-btn:hover {
            background: #c82333;
            transform: scale(1.1);
        }

        .entry-item input, .exit-item input {
            width: 100%;
            padding: 8px;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            font-size: 0.9rem;
        }

        .entry-item input:focus, .exit-item input:focus {
            outline: none;
            border-color: #4facfe;
            box-shadow: 0 0 0 2px rgba(79, 172, 254, 0.1);
        }

        .add-entry-section, .add-exit-section {
            display: flex;
            justify-content: center;
            align-items: center;
            grid-column: 1 / -1;
        }

        .add-entry-btn, .add-exit-btn {
            background: linear-gradient(135deg, #6c757d 0%, #495057 100%);
            color: white;
            border: 2px dashed #dee2e6;
            padding: 10px 20px;
            font-size: 0.9rem;
            font-weight: 600;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .add-entry-btn:hover, .add-exit-btn:hover {
            background: linear-gradient(135deg, #495057 0%, #343a40 100%);
            border-color: #4facfe;
            transform: translateY(-2px);
        }

        .calculated-stays-container {
            margin-top: 30px;
        }

        .calculated-stays {
            background: #e8f5e8;
            border: 2px solid #28a745;
            border-radius: 12px;
            padding: 20px;
        }

        .calculated-stays h3 {
            color: #155724;
            margin-bottom: 15px;
            font-size: 1.1rem;
        }

        .stays-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .calculated-stay-item {
            background: white;
            border: 1px solid #c3e6cb;
            border-radius: 8px;
            padding: 15px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .stay-number {
            background: #28a745;
            color: white;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.9rem;
        }

        .stay-details {
            flex: 1;
        }

        .stay-period {
            font-weight: 600;
            color: #495057;
            margin-bottom: 5px;
        }

        .stay-duration {
            color: #28a745;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .calculated-stays-empty {
            text-align: center;
            padding: 40px;
            color: #6c757d;
            font-style: italic;
        }

        .date-inputs {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 10px;
        }

        .input-group {
            display: flex;
            flex-direction: column;
        }

        .input-group label {
            margin-bottom: 5px;
            font-weight: 600;
            color: #555;
        }

        .input-group input, .input-group select {
            padding: 12px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .input-group input:focus, .input-group select:focus {
            outline: none;
            border-color: #4facfe;
            box-shadow: 0 0 0 3px rgba(79, 172, 254, 0.1);
        }

        .days-display {
            text-align: right;
            color: #6c757d;
            font-weight: 600;
            margin-top: 10px;
        }

        .add-stay-section {
            text-align: center;
            margin: 20px 0;
        }

        .add-stay-btn {
            background: linear-gradient(135deg, #6c757d 0%, #495057 100%);
            color: white;
            border: 2px dashed #dee2e6;
            padding: 15px 30px;
            font-size: 1rem;
            font-weight: 600;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 3px 10px rgba(108, 117, 125, 0.2);
        }

        .add-stay-btn:hover {
            background: linear-gradient(135deg, #495057 0%, #343a40 100%);
            border-color: #4facfe;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(108, 117, 125, 0.3);
        }

        .calculate-btn {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.1rem;
            font-weight: 600;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: block;
            margin: 30px auto;
            box-shadow: 0 5px 15px rgba(79, 172, 254, 0.3);
        }

        .calculate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(79, 172, 254, 0.4);
        }

        .results {
            margin-top: 30px;
            padding: 25px;
            background: #f8f9fa;
            border-radius: 12px;
            border: 2px solid #e9ecef;
        }

        .results.hidden {
            display: none;
        }

        .result-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        .result-item:last-child {
            margin-bottom: 0;
        }

        .result-label {
            font-weight: 600;
            color: #495057;
        }

        .result-value {
            font-weight: 700;
            font-size: 1.1rem;
        }

        .status-legal {
            color: #28a745;
        }

        .status-illegal {
            color: #dc3545;
        }

        .status-warning {
            color: #ffc107;
        }

        .next-entry-date {
            background: #fff3cd;
            border: 2px solid #ffeaa7;
            color: #856404;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            text-align: center;
            font-weight: 600;
        }

        .print-section {
            text-align: center;
            margin-top: 25px;
            padding-top: 20px;
            border-top: 1px solid #e9ecef;
        }

        .print-btn {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            font-size: 1rem;
            font-weight: 600;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(40, 167, 69, 0.3);
        }

        .print-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(40, 167, 69, 0.4);
        }

        .footer {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-top: 1px solid #dee2e6;
            margin-top: 40px;
        }

        .footer-content {
            padding: 40px 30px;
            max-width: 800px;
            margin: 0 auto;
            color: #495057;
            line-height: 1.6;
        }

        .footer-content h2 {
            color: #2c3e50;
            font-size: 1.5rem;
            margin-bottom: 20px;
            text-align: center;
            font-weight: 600;
        }

        .footer-content h3 {
            color: #34495e;
            font-size: 1.2rem;
            margin: 25px 0 15px 0;
            font-weight: 600;
        }

        .intro-text {
            font-size: 1.1rem;
            text-align: center;
            margin-bottom: 20px;
            color: #2c3e50;
            font-weight: 500;
        }

        .features-text {
            margin-bottom: 10px;
            font-weight: 500;
        }

        .feature-list {
            margin-bottom: 30px;
            padding-left: 20px;
        }

        .feature-list li {
            margin-bottom: 8px;
        }

        .section {
            margin-bottom: 30px;
        }

        .section ul {
            margin: 15px 0;
            padding-left: 20px;
        }

        .section ul li {
            margin-bottom: 8px;
        }

        .benefits {
            background: #e8f5e8;
            border-left: 4px solid #28a745;
            padding: 20px;
            border-radius: 8px;
            margin-top: 30px;
        }

        .benefits p {
            margin-bottom: 8px;
            font-weight: 600;
            color: #155724;
        }

        .benefits p:last-child {
            margin-bottom: 0;
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 15px;
            }

            .header {
                padding: 20px;
            }

            .header h1 {
                font-size: 1.8rem;
            }

            .content {
                padding: 20px;
            }

            .controls {
                flex-direction: column;
                align-items: stretch;
            }

            .period-display {
                padding: 15px 20px;
            }

            .period-dates {
                font-size: 1.1rem;
            }

            .mode-switch {
                justify-content: center;
            }

            .date-inputs, .visa-inputs {
                grid-template-columns: 1fr;
                gap: 10px;
            }

            .result-item {
                flex-direction: column;
                gap: 5px;
                text-align: center;
            }

            .footer-content {
                padding: 30px 20px;
            }

            .footer-content h2 {
                font-size: 1.3rem;
            }

            .footer-content h3 {
                font-size: 1.1rem;
            }

            .intro-text {
                font-size: 1rem;
            }

            .print-btn {
                padding: 10px 20px;
                font-size: 0.9rem;
            }

            .add-stay-btn {
                padding: 12px 20px;
                font-size: 0.9rem;
            }

            .delete-stay-btn {
                min-width: 35px;
                height: 35px;
                padding: 6px 8px;
                font-size: 0.9rem;
            }

            .stay-header {
                gap: 10px;
            }

            .entries-grid, .exits-grid {
                grid-template-columns: 1fr;
                gap: 10px;
            }

            .calculated-stay-item {
                flex-direction: column;
                text-align: center;
                gap: 10px;
            }

            .stay-details {
                order: 1;
            }

            .stay-number {
                order: 2;
                align-self: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 id="headerTitle">üá™üá∫ Schengen & Visa Aufenthaltsrechner</h1>
            <p id="headerSubtitle">Berechnen Sie Ihre verbleibenden Aufenthaltstage</p>
        </div>
        
        <div class="controls">
            <div class="language-selector">
                <span id="languageLabel">Sprache:</span>
                <button class="language-btn active" onclick="setLanguage('de')">üá©üá™ DE</button>
                <button class="language-btn" onclick="setLanguage('en')">üá¨üáß EN</button>
            </div>
            
            <div class="mode-switch">
                <div class="mode-labels">
                    <span id="mode1Label">Schengen 90/180</span>
                    <label class="switch">
                        <input type="checkbox" id="modeSwitch" onchange="toggleMode()">
                        <span class="slider"></span>
                    </label>
                    <span id="mode2Label">Visum-Pr√ºfung</span>
                </div>
            </div>
        </div>
        
        <div class="period-display" id="periodDisplay">
            <div class="period-content">
                <h3 id="calculationPeriodTitle">üìÖ Aktueller Berechnungszeitraum</h3>
                <div class="period-dates" id="periodDates">
                    <span id="periodStart">-</span> ‚Üí <span id="periodEnd">-</span>
                </div>
                <div class="period-note" id="periodNote">
                    Aufenthalte in diesem 180-Tage-Zeitraum werden ber√ºcksichtigt
                </div>
            </div>
        </div>
        
        <div class="content">
            <!-- Schengen Mode -->
            <div id="schengenMode" class="mode-section active">
                <div class="info-box">
                    <h3 id="schengenRuleTitle">Schengen-Regel (90/180 Tage)</h3>
                    <p id="schengenRuleText">Als Tourist d√ºrfen Sie sich maximal <strong>90 Tage</strong> innerhalb von <strong>180 aufeinanderfolgenden Tagen</strong> im Schengen-Raum aufhalten. Geben Sie Ihre bisherigen und geplanten Aufenthalte ein, um Ihre verbleibenden Tage zu berechnen.</p>
                </div>

                <div id="schengenStayEntries"></div>
                
                <button type="button" class="calculate-btn" onclick="calculateSchengen()" id="schengenCalculateBtn">
                    üìä Aufenthaltstage berechnen
                </button>
            </div>

            <!-- Visa Mode -->
            <div id="visaMode" class="mode-section">
                <div class="info-box">
                    <h3 id="visaRuleTitle">Visum-Zeitraum Pr√ºfung</h3>
                    <p id="visaRuleText">Geben Sie Ihre Visum-Details ein und pr√ºfen Sie, ob Ihre geplanten Aufenthalte innerhalb der Visum-Beschr√§nkungen liegen.</p>
                </div>

                <div class="visa-config">
                    <h3 id="visaConfigTitle">üõÇ Visum-Konfiguration</h3>
                    <div class="visa-inputs">
                        <div class="input-group">
                            <label for="visaStart" id="visaStartLabel">Visum g√ºltig ab</label>
                            <input type="date" id="visaStart" onchange="updatePeriodDisplay()">
                        </div>
                        <div class="input-group">
                            <label for="visaEnd" id="visaEndLabel">Visum g√ºltig bis</label>
                            <input type="date" id="visaEnd" onchange="updatePeriodDisplay()">
                        </div>
                        <div class="input-group">
                            <label for="allowedDays" id="allowedDaysLabel">Erlaubte Aufenthaltstage</label>
                            <input type="number" id="allowedDays" min="1" max="365" placeholder="z.B. 90">
                        </div>
                        <div class="input-group">
                            <label for="allowedEntries" id="allowedEntriesLabel">Erlaubte Einreisen</label>
                            <select id="allowedEntries">
                                <option value="1" id="singleEntry">1 (Einmalig)</option>
                                <option value="2" id="doubleEntry">2 (Zweimalig)</option>
                                <option value="multi" id="multiEntry">MULTI (Mehrfach)</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div id="visaStayEntries"></div>
                
                <button type="button" class="calculate-btn" onclick="calculateVisa()" id="visaCalculateBtn">
                    üîç Visum-Compliance pr√ºfen
                </button>
            </div>

            <div id="results" class="results hidden">
                <h3 id="resultsTitle" style="margin-bottom: 20px; color: #495057;">üîç Berechnungsergebnis</h3>
                <div id="resultsList"></div>
                <div class="print-section">
                    <button type="button" class="print-btn" onclick="printResults()" id="printBtn">
                        üìÑ <span id="printBtnText">Drucken/Exportieren</span>
                    </button>
                </div>
            </div>
        </div>
        
        <div class="footer">
            <div class="footer-content">
                <h2 id="footerTitle">üõÇ Aufenthaltsrechner f√ºr Schengen | 90 Tage in 180 Tagen + Visumspr√ºfung</h2>
                
                <p class="intro-text" id="footerIntro">
                    Mit unserem kostenlosen Aufenthaltsrechner kannst du ganz einfach pr√ºfen, wie viele Aufenthaltstage im Schengen-Raum du bereits verbraucht hast, wie viele Tage dir noch bleiben ‚Äì und ob du aktuell legal eingereist bist.
                </p>
                
                <p class="features-text" id="footerFeatures">
                    Die Berechnung ber√ºcksichtigt sowohl:
                </p>
                
                <ul class="feature-list">
                    <li><strong id="footerFeature1">die klassische 90/180-Tage-Regel</strong> (f√ºr visumfreies Reisen)</li>
                    <li><strong id="footerFeature2">als auch Aufenthaltszeiten innerhalb eines Schengen-Visums</strong> (z. B. Typ-C-Visum mit begrenztem G√ºltigkeitszeitraum)</li>
                </ul>
                
                <div class="section">
                    <h3 id="footerWhatTitle">üîç Was macht unser Aufenthaltsrechner?</h3>
                    <ul>
                        <li id="footerWhat1">Berechnet automatisch, wie viele Tage du im aktuellen 180-Tage-Zeitraum verbracht hast</li>
                        <li id="footerWhat2">Zeigt, wie viele Aufenthaltstage noch √ºbrig sind</li>
                        <li id="footerWhat3">Pr√ºft bei Bedarf auch, ob du dein Schengen-Visum korrekt nutzt</li>
                        <li id="footerWhat4">Gibt an, ab wann eine erneute legale Einreise m√∂glich ist</li>
                    </ul>
                    <p id="footerWhatNote">Du gibst einfach deine einzelnen Aufenthaltszeitr√§ume oder deinen Visumszeitraum ein ‚Äì alles andere √ºbernimmt das Tool.</p>
                </div>
                
                <div class="section">
                    <h3 id="footerWhoTitle">üë§ F√ºr wen ist der Rechner n√ºtzlich?</h3>
                    <ul>
                        <li id="footerWho1">Touristen mit visumfreier Einreise (z. B. aus UK, USA, Kanada, Australien)</li>
                        <li id="footerWho2">Visa-Inhaber, die ihre 90 Tage im Visumszeitraum einhalten m√ºssen</li>
                        <li id="footerWho3">Digitale Nomaden, Gesch√§ftsreisende, Au-Pairs</li>
                        <li id="footerWho4">Alle, die rechtssicher im Schengen-Raum reisen m√∂chten</li>
                    </ul>
                </div>
                
                <div class="benefits">
                    <p id="footerBenefit1">‚úî Die Berechnung erfolgt direkt im Browser ‚Äì keine Datenspeicherung, keine Anmeldung n√∂tig.</p>
                    <p id="footerBenefit2">‚úî Ideal zur Planung, Dokumentation oder zum Nachweis gegen√ºber Beh√∂rden.</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentLanguage = 'de';
        let currentMode = 'schengen';
        let visibleEntries = 1;
        let visibleExits = 1;
        let calculationPeriodData = null;

        const translations = {
            de: {
                headerTitle: 'üá™üá∫ Schengen & Visa Aufenthaltsrechner',
                headerSubtitle: 'Berechnen Sie Ihre verbleibenden Aufenthaltstage',
                languageLabel: 'Sprache:',
                mode1Label: 'Schengen 90/180',
                mode2Label: 'Visum-Pr√ºfung',
                schengenRuleTitle: 'Schengen-Regel (90/180 Tage)',
                schengenRuleText: 'Als Tourist d√ºrfen Sie sich maximal <strong>90 Tage</strong> innerhalb von <strong>180 aufeinanderfolgenden Tagen</strong> im Schengen-Raum aufhalten. Geben Sie Ihre bisherigen und geplanten Aufenthalte ein, um Ihre verbleibenden Tage zu berechnen.',
                visaRuleTitle: 'Visum-Zeitraum Pr√ºfung',
                visaRuleText: 'Geben Sie Ihre Visum-Details ein und pr√ºfen Sie, ob Ihre geplanten Aufenthalte innerhalb der Visum-Beschr√§nkungen liegen.',
                visaConfigTitle: 'üõÇ Visum-Konfiguration',
                visaStartLabel: 'Visum g√ºltig ab',
                visaEndLabel: 'Visum g√ºltig bis',
                allowedDaysLabel: 'Erlaubte Aufenthaltstage',
                allowedEntriesLabel: 'Erlaubte Einreisen',
                schengenCalculateBtn: 'üìä Aufenthaltstage berechnen',
                visaCalculateBtn: 'üîç Visum-Compliance pr√ºfen',
                printBtnText: 'Drucken/Exportieren',
                addStayBtn: '+ Aufenthalt hinzuf√ºgen',
                addEntryBtn: '+ Einreise hinzuf√ºgen',
                addExitBtn: '+ Ausreise hinzuf√ºgen',
                entryLabel: 'Einreise',
                exitLabel: 'Ausreise',
                entryDateLabel: 'Einreisedatum',
                exitDateLabel: 'Ausreisedatum',
                calculatedStaysTitle: 'Berechnete Aufenthaltszeiten',
                emptyStaysMessage: 'Geben Sie Ein- und Ausreisedaten ein, um Aufenthaltszeiten zu berechnen.',
                stayOverviewTitle: 'Eingegebene Aufenthalte',
                calculationPeriodTitle: 'Aktueller Berechnungszeitraum',
                calculationPeriodSchengen: 'Aufenthalte in diesem 180-Tage-Zeitraum werden ber√ºcksichtigt',
                calculationPeriodVisa: 'Bitte Visum-Daten eingeben um Zeitraum anzuzeigen',
                today: 'Heute',
                resultsTitle: 'üîç Berechnungsergebnis',
                stayLabel: 'Aufenthalt',
                arrivalLabel: 'Ankunftsdatum',
                departureLabel: 'Abreisedatum',
                daysText: 'Tag',
                daysTextPlural: 'Tage',
                usedDaysLabel: 'üìä Genutzte Aufenthaltstage (180-Tage-Zeitraum)',
                usedDaysVisaLabel: 'üìä Genutzte Aufenthaltstage (Visum-Zeitraum)',
                remainingDaysLabel: '‚è∞ Verbleibende Aufenthaltstage',
                statusLabel: '‚öñÔ∏è Aktueller Status',
                calculationDateLabel: 'üìÖ Berechnungsstichtag',
                entriesUsedLabel: 'üö™ Verwendete Einreisen',
                statusLegal: '‚úÖ Legal',
                statusExhausted: '‚ö†Ô∏è Ausgesch√∂pft (0 Tage √ºbrig)',
                statusViolation: '‚ùå √úberschreitung',
                statusVisaValid: '‚úÖ Visum-konform',
                statusVisaViolation: '‚ùå Visum-Verletzung',
                nextEntryText: 'üö™ N√§chstm√∂gliche legale Einreise:',
                errorEndDate: '‚ö†Ô∏è Enddatum muss nach Startdatum liegen',
                errorNoStays: 'Bitte geben Sie mindestens einen Aufenthaltszeitraum ein.',
                errorVisaConfig: 'Bitte f√ºllen Sie alle Visum-Felder aus.',
                errorVisaDates: 'Visum-Enddatum muss nach Startdatum liegen.',
                errorStayOutsideVisa: '‚ö†Ô∏è Aufenthalt au√üerhalb des Visum-Zeitraums',
                tooManyEntries: 'Zu viele Einreisen',
                daysOverLimit: 'Tage √ºberschritten',
                // Footer √úbersetzungen
                footerTitle: 'üõÇ Aufenthaltsrechner f√ºr Schengen | 90 Tage in 180 Tagen + Visumspr√ºfung',
                footerIntro: 'Mit unserem kostenlosen Aufenthaltsrechner kannst du ganz einfach pr√ºfen, wie viele Aufenthaltstage im Schengen-Raum du bereits verbraucht hast, wie viele Tage dir noch bleiben ‚Äì und ob du aktuell legal eingereist bist.',
                footerFeatures: 'Die Berechnung ber√ºcksichtigt sowohl:',
                footerFeature1: 'die klassische 90/180-Tage-Regel (f√ºr visumfreies Reisen)',
                footerFeature2: 'als auch Aufenthaltszeiten innerhalb eines Schengen-Visums (z. B. Typ-C-Visum mit begrenztem G√ºltigkeitszeitraum)',
                footerWhatTitle: 'üîç Was macht unser Aufenthaltsrechner?',
                footerWhat1: 'Berechnet automatisch, wie viele Tage du im aktuellen 180-Tage-Zeitraum verbracht hast',
                footerWhat2: 'Zeigt, wie viele Aufenthaltstage noch √ºbrig sind',
                footerWhat3: 'Pr√ºft bei Bedarf auch, ob du dein Schengen-Visum korrekt nutzt',
                footerWhat4: 'Gibt an, ab wann eine erneute legale Einreise m√∂glich ist',
                footerWhatNote: 'Du gibst einfach deine einzelnen Aufenthaltszeitr√§ume oder deinen Visumszeitraum ein ‚Äì alles andere √ºbernimmt das Tool.',
                footerWhoTitle: 'üë§ F√ºr wen ist der Rechner n√ºtzlich?',
                footerWho1: 'Touristen mit visumfreier Einreise (z. B. aus UK, USA, Kanada, Australien)',
                footerWho2: 'Visa-Inhaber, die ihre 90 Tage im Visumszeitraum einhalten m√ºssen',
                footerWho3: 'Digitale Nomaden, Gesch√§ftsreisende, Au-Pairs',
                footerWho4: 'Alle, die rechtssicher im Schengen-Raum reisen m√∂chten',
                footerBenefit1: '‚úî Die Berechnung erfolgt direkt im Browser ‚Äì keine Datenspeicherung, keine Anmeldung n√∂tig.',
                footerBenefit2: '‚úî Ideal zur Planung, Dokumentation oder zum Nachweis gegen√ºber Beh√∂rden.',
                violationsTitle: 'Verst√∂√üe',
                remaining: '√ºbrig',
                placeholder90: 'z.B. 90',
                singleEntry: '1 (Einmalig)',
                doubleEntry: '2 (Zweimalig)',
                multiEntry: 'MULTI (Mehrfach)',
                visaPeriodLabel: 'Visum-Zeitraum',
                createdOn: 'Erstellt am',
                pageInfo: 'Seite 1 von 1',
                createdWith: 'Erstellt mit: Schengen Aufenthaltsrechner',
                disclaimer: 'Hinweis: Diese Berechnung dient zur Orientierung. Bei rechtlichen Fragen wenden Sie sich an die zust√§ndigen Beh√∂rden.'
            },
            en: {
                headerTitle: 'üá™üá∫ Schengen & Visa Stay Calculator',
                headerSubtitle: 'Calculate your remaining stay days',
                languageLabel: 'Language:',
                mode1Label: 'Schengen 90/180',
                mode2Label: 'Visa Check',
                schengenRuleTitle: 'Schengen Rule (90/180 days)',
                schengenRuleText: 'As a tourist, you may stay a maximum of <strong>90 days</strong> within <strong>180 consecutive days</strong> in the Schengen area. Enter your previous and planned stays to calculate your remaining days.',
                visaRuleTitle: 'Visa Period Check',
                visaRuleText: 'Enter your visa details and check if your planned stays are within the visa restrictions.',
                visaConfigTitle: 'üõÇ Visa Configuration',
                visaStartLabel: 'Visa valid from',
                visaEndLabel: 'Visa valid until',
                allowedDaysLabel: 'Allowed stay days',
                allowedEntriesLabel: 'Allowed entries',
                schengenCalculateBtn: 'üìä Calculate stay days',
                visaCalculateBtn: 'üîç Check visa compliance',
                printBtnText: 'Print/Export',
                addStayBtn: '+ Add stay',
                addEntryBtn: '+ Add entry',
                addExitBtn: '+ Add exit',
                entryLabel: 'Entry',
                exitLabel: 'Exit',
                entryDateLabel: 'Entry date',
                exitDateLabel: 'Exit date',
                calculatedStaysTitle: 'Calculated stay periods',
                emptyStaysMessage: 'Enter entry and exit dates to calculate stay periods.',
                stayOverviewTitle: 'Entered stays',
                calculationPeriodTitle: 'Current calculation period',
                calculationPeriodSchengen: 'Stays within this 180-day period are considered',
                calculationPeriodVisa: 'Please enter visa data to display period',
                today: 'Today',
                resultsTitle: 'üîç Calculation Result',
                stayLabel: 'Stay',
                arrivalLabel: 'Arrival date',
                departureLabel: 'Departure date',
                daysText: 'day',
                daysTextPlural: 'days',
                usedDaysLabel: 'üìä Used stay days (180-day period)',
                usedDaysVisaLabel: 'üìä Used stay days (visa period)',
                remainingDaysLabel: '‚è∞ Remaining stay days',
                statusLabel: '‚öñÔ∏è Current status',
                calculationDateLabel: 'üìÖ Calculation date',
                entriesUsedLabel: 'üö™ Entries used',
                statusLegal: '‚úÖ Legal',
                statusExhausted: '‚ö†Ô∏è Exhausted (0 days left)',
                statusViolation: '‚ùå Violation',
                statusVisaValid: '‚úÖ Visa compliant',
                statusVisaViolation: '‚ùå Visa violation',
                nextEntryText: 'üö™ Next possible legal entry:',
                errorEndDate: '‚ö†Ô∏è End date must be after start date',
                errorNoStays: 'Please enter at least one stay period.',
                errorVisaConfig: 'Please fill in all visa fields.',
                errorVisaDates: 'Visa end date must be after start date.',
                errorStayOutsideVisa: '‚ö†Ô∏è Stay outside visa period',
                tooManyEntries: 'Too many entries',
                daysOverLimit: 'Days exceeded',
                // Footer Translations
                footerTitle: 'üõÇ Schengen Stay Calculator | 90 days in 180 days + Visa Check',
                footerIntro: 'With our free stay calculator, you can easily check how many stay days in the Schengen area you have already used, how many days you have left ‚Äì and whether you are currently legally entered.',
                footerFeatures: 'The calculation considers both:',
                footerFeature1: 'the classic 90/180-day rule (for visa-free travel)',
                footerFeature2: 'as well as stays within a Schengen visa (e.g. Type C visa with limited validity period)',
                footerWhatTitle: 'üîç What does our stay calculator do?',
                footerWhat1: 'Automatically calculates how many days you have spent in the current 180-day period',
                footerWhat2: 'Shows how many stay days are left',
                footerWhat3: 'Also checks whether you are using your Schengen visa correctly if needed',
                footerWhat4: 'Indicates when a legal re-entry is possible again',
                footerWhatNote: 'You simply enter your individual stay periods or your visa period ‚Äì the tool takes care of everything else.',
                footerWhoTitle: 'üë§ Who is the calculator useful for?',
                footerWho1: 'Tourists with visa-free entry (e.g. from UK, USA, Canada, Australia)',
                footerWho2: 'Visa holders who must comply with their 90 days within the visa period',
                footerWho3: 'Digital nomads, business travelers, au pairs',
                footerWho4: 'Anyone who wants to travel legally in the Schengen area',
                footerBenefit1: '‚úî The calculation is done directly in the browser ‚Äì no data storage, no registration required.',
                footerBenefit2: '‚úî Ideal for planning, documentation or proof to authorities.',
                violationsTitle: 'Violations',
                remaining: 'left',
                placeholder90: 'e.g. 90',
                singleEntry: '1 (Single)',
                doubleEntry: '2 (Double)',
                multiEntry: 'MULTI (Multiple)',
                visaPeriodLabel: 'Visa Period',
                createdOn: 'Created on',
                pageInfo: 'Page 1 of 1',
                createdWith: 'Created with: Schengen Stay Calculator',
                disclaimer: 'Note: This calculation is for guidance only. For legal questions, contact the relevant authorities.'
            }
        };

        function setLanguage(lang) {
            currentLanguage = lang;
            
            document.querySelectorAll('.language-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            for (const [key, value] of Object.entries(translations[lang])) {
                const element = document.getElementById(key);
                if (element) {
                    element.innerHTML = value;
                }
            }
            
            // Platzhalter und Select-Optionen √ºbersetzen
            const allowedDaysInput = document.getElementById('allowedDays');
            if (allowedDaysInput) {
                allowedDaysInput.placeholder = translations[lang].placeholder90;
            }
            
            const singleEntry = document.getElementById('singleEntry');
            const doubleEntry = document.getElementById('doubleEntry');
            const multiEntry = document.getElementById('multiEntry');
            
            if (singleEntry) singleEntry.textContent = translations[lang].singleEntry;
            if (doubleEntry) doubleEntry.textContent = translations[lang].doubleEntry;
            if (multiEntry) multiEntry.textContent = translations[lang].multiEntry;
            
            generateStayEntries();
            updatePeriodDisplay();
        }

        function updatePeriodDisplay() {
            const periodStart = document.getElementById('periodStart');
            const periodEnd = document.getElementById('periodEnd');
            const periodNote = document.getElementById('periodNote');
            
            if (currentMode === 'schengen') {
                const today = new Date();
                const period180Start = new Date(today);
                period180Start.setDate(period180Start.getDate() - 180);
                
                periodStart.textContent = period180Start.toLocaleDateString(currentLanguage === 'de' ? 'de-DE' : 'en-GB');
                periodEnd.textContent = today.toLocaleDateString(currentLanguage === 'de' ? 'de-DE' : 'en-GB') + ` (${translations[currentLanguage].today})`;
                periodNote.textContent = translations[currentLanguage].calculationPeriodSchengen;
            } else {
                const visaStart = document.getElementById('visaStart')?.value;
                const visaEnd = document.getElementById('visaEnd')?.value;
                
                if (visaStart && visaEnd) {
                    const startDate = new Date(visaStart);
                    const endDate = new Date(visaEnd);
                    
                    periodStart.textContent = startDate.toLocaleDateString(currentLanguage === 'de' ? 'de-DE' : 'en-GB');
                    periodEnd.textContent = endDate.toLocaleDateString(currentLanguage === 'de' ? 'de-DE' : 'en-GB');
                    periodNote.textContent = currentLanguage === 'de' ? 'Alle Aufenthalte m√ºssen innerhalb dieses Visum-Zeitraums liegen' : 'All stays must be within this visa period';
                } else {
                    periodStart.textContent = '-';
                    periodEnd.textContent = '-';
                    periodNote.textContent = translations[currentLanguage].calculationPeriodVisa;
                }
            }
        }

        function toggleMode() {
            const modeSwitch = document.getElementById('modeSwitch');
            const schengenMode = document.getElementById('schengenMode');
            const visaMode = document.getElementById('visaMode');
            const results = document.getElementById('results');
            
            visibleEntries = 1;
            visibleExits = 1;
            
            if (modeSwitch.checked) {
                currentMode = 'visa';
                schengenMode.classList.remove('active');
                visaMode.classList.add('active');
            } else {
                currentMode = 'schengen';
                schengenMode.classList.add('active');
                visaMode.classList.remove('active');
            }
            
            results.classList.add('hidden');
            generateStayEntries();
            updatePeriodDisplay();
        }

        function saveCurrentInputs() {
            const savedData = {};
            
            // Einreisen speichern
            for (let i = 1; i <= 10; i++) {
                const entryInput = document.getElementById(`${currentMode}Entry${i}`);
                if (entryInput) {
                    savedData[`${currentMode}Entry${i}`] = entryInput.value;
                }
            }
            
            // Ausreisen speichern
            for (let i = 1; i <= 10; i++) {
                const exitInput = document.getElementById(`${currentMode}Exit${i}`);
                if (exitInput) {
                    savedData[`${currentMode}Exit${i}`] = exitInput.value;
                }
            }
            
            return savedData;
        }

        function restoreInputs(savedData) {
            for (const [id, value] of Object.entries(savedData)) {
                const input = document.getElementById(id);
                if (input && value) {
                    input.value = value;
                }
            }
            // Nach dem Wiederherstellen die Aufenthalte neu berechnen
            calculateStayPeriods();
        }

        function calculateStayPeriods() {
            const entries = [];
            const exits = [];
            
            // Alle Einreisen sammeln
            for (let i = 1; i <= 10; i++) {
                const entryInput = document.getElementById(`${currentMode}Entry${i}`);
                if (entryInput && entryInput.value) {
                    entries.push({
                        date: new Date(entryInput.value),
                        index: i
                    });
                }
            }
            
            // Alle Ausreisen sammeln
            for (let i = 1; i <= 10; i++) {
                const exitInput = document.getElementById(`${currentMode}Exit${i}`);
                if (exitInput && exitInput.value) {
                    exits.push({
                        date: new Date(exitInput.value),
                        index: i
                    });
                }
            }
            
            // Sortieren nach Datum
            entries.sort((a, b) => a.date.getTime() - b.date.getTime());
            exits.sort((a, b) => a.date.getTime() - b.date.getTime());
            
            // Aufenthaltszeiten berechnen
            const stayPeriods = [];
            const minLength = Math.min(entries.length, exits.length);
            
            for (let i = 0; i < minLength; i++) {
                const entry = entries[i];
                const exit = exits[i];
                
                if (entry.date <= exit.date) {
                    const timeDiff = exit.date.getTime() - entry.date.getTime();
                    const days = Math.ceil(timeDiff / (1000 * 3600 * 24)) + 1;
                    
                    stayPeriods.push({
                        number: i + 1,
                        entryDate: entry.date,
                        exitDate: exit.date,
                        days: days
                    });
                }
            }
            
            displayCalculatedStays(stayPeriods);
            return stayPeriods;
        }

        function displayCalculatedStays(stayPeriods) {
            const containerId = currentMode === 'schengen' ? 'schengenCalculatedStays' : 'visaCalculatedStays';
            const container = document.getElementById(containerId);
            
            if (!container) return;
            
            if (stayPeriods.length === 0) {
                container.innerHTML = `
                    <div class="calculated-stays-empty">
                        <p>${translations[currentLanguage].emptyStaysMessage}</p>
                    </div>
                `;
                return;
            }
            
            let html = `
                <div class="calculated-stays">
                    <h3>${translations[currentLanguage].calculatedStaysTitle}</h3>
                    <div class="stays-list">
            `;
            
            stayPeriods.forEach(stay => {
                html += `
                    <div class="calculated-stay-item">
                        <div class="stay-number">${stay.number}</div>
                        <div class="stay-details">
                            <div class="stay-period">
                                ${stay.entryDate.toLocaleDateString(currentLanguage === 'de' ? 'de-DE' : 'en-GB')} ‚Üí 
                                ${stay.exitDate.toLocaleDateString(currentLanguage === 'de' ? 'de-DE' : 'en-GB')}
                            </div>
                            <div class="stay-duration">${stay.days} ${stay.days === 1 ? translations[currentLanguage].daysText : translations[currentLanguage].daysTextPlural}</div>
                        </div>
                    </div>
                `;
            });
            
            html += `
                    </div>
                </div>
            `;
            
            container.innerHTML = html;
        }
            const containerId = currentMode === 'schengen' ? 'schengenStayEntries' : 'visaStayEntries';
            const container = document.getElementById(containerId);
            
            // Aktuelle Eingaben speichern
            const savedData = saveCurrentInputs();
            
            container.innerHTML = '';
            
            for (let i = 1; i <= visibleStays; i++) {
                const deleteButton = i > 1 ? `
                    <button type="button" class="delete-stay-btn" onclick="removeStayEntry(${i})" title="Aufenthalt entfernen">
                        üóëÔ∏è
                    </button>
                ` : '';
                
                const entryHTML = `
                    <div class="stay-entry">
                        <div class="stay-header">
                            <h3>üèõÔ∏è ${translations[currentLanguage].stayLabel} ${i}</h3>
                            ${deleteButton}
                        </div>
                        <div class="date-inputs">
                            <div class="input-group">
                                <label for="${currentMode}Start${i}">${translations[currentLanguage].arrivalLabel}</label>
                                <input type="date" id="${currentMode}Start${i}" name="${currentMode}Start${i}" onchange="calculateDays('${currentMode}', ${i})">
                            </div>
                            <div class="input-group">
                                <label for="${currentMode}End${i}">${translations[currentLanguage].departureLabel}</label>
                                <input type="date" id="${currentMode}End${i}" name="${currentMode}End${i}" onchange="calculateDays('${currentMode}', ${i})">
                            </div>
                        </div>
                        <div class="days-display" id="${currentMode}Days${i}"></div>
                    </div>
                `;
                container.innerHTML += entryHTML;
            }
            
            if (visibleStays < 5) {
                const addButtonHTML = `
                    <div class="add-stay-section">
                        <button type="button" class="add-stay-btn" onclick="addStayEntry()">
                            ${translations[currentLanguage].addStayBtn}
                        </button>
                    </div>
                `;
                container.innerHTML += addButtonHTML;
            }
            
            // Gespeicherte Eingaben wiederherstellen
            setTimeout(() => {
                restoreInputs(savedData);
            }, 10);
        }

        
        function generateStayEntries() {
            const containerId = currentMode === 'schengen' ? 'schengenStayEntries' : 'visaStayEntries';
            const container = document.getElementById(containerId);

            // Aktuelle Eingaben speichern
            const savedData = saveCurrentInputs();

            container.innerHTML = '';

            for (let i = 1; i <= visibleStays; i++) {
                const deleteButton = i > 1 ? `
                    <button type="button" class="delete-stay-btn" onclick="removeStayEntry(${i})" title="Aufenthalt entfernen">
                        üóëÔ∏è
                    </button>
                ` : '';

                const entryHTML = `
                    <div class="stay-entry">
                        <div class="stay-header">
                            <h3>üèõÔ∏è ${translations[currentLanguage].stayLabel} ${i}</h3>
                            ${deleteButton}
                        </div>
                        <div class="date-inputs">
                            <div class="input-group">
                                <label for="${currentMode}Start${i}">${translations[currentLanguage].arrivalLabel}</label>
                                <input type="date" id="${currentMode}Start${i}" name="${currentMode}Start${i}" onchange="calculateDays('${currentMode}', ${i})">
                            </div>
                            <div class="input-group">
                                <label for="${currentMode}End${i}">${translations[currentLanguage].departureLabel}</label>
                                <input type="date" id="${currentMode}End${i}" name="${currentMode}End${i}" onchange="calculateDays('${currentMode}', ${i})">
                            </div>
                        </div>
                        <div class="days-display" id="${currentMode}Days${i}"></div>
                    </div>
                `;
                container.innerHTML += entryHTML;
            }

            if (visibleStays < 5) {
                const addButtonHTML = `
                    <div class="add-stay-section">
                        <button type="button" class="add-stay-btn" onclick="addStayEntry()">
                            ${translations[currentLanguage].addStayBtn}
                        </button>
                    </div>
                `;
                container.innerHTML += addButtonHTML;
            }

            // Gespeicherte Eingaben wiederherstellen
            setTimeout(() => {
                restoreInputs(savedData);
            }, 10);
        }


function removeStayEntry(entryIndex) {
            if (visibleStays > 1 && entryIndex > 1) {
                // Aktuelle Daten speichern
                const savedData = saveCurrentInputs();
                
                // Daten f√ºr gel√∂schten Eintrag entfernen
                delete savedData[`${currentMode}Start${entryIndex}`];
                delete savedData[`${currentMode}End${entryIndex}`];
                
                // Daten f√ºr h√∂here Indizes nach unten verschieben
                const adjustedData = {};
                for (const [key, value] of Object.entries(savedData)) {
                    const match = key.match(/(\w+)(Start|End)(\d+)/);
                    if (match) {
                        const mode = match[1];
                        const type = match[2];
                        const index = parseInt(match[3]);
                        
                        if (index < entryIndex) {
                            // Behalten
                            adjustedData[key] = value;
                        } else if (index > entryIndex) {
                            // Nach unten verschieben
                            const newKey = `${mode}${type}${index - 1}`;
                            adjustedData[newKey] = value;
                        }
                        // index === entryIndex wird √ºbersprungen (gel√∂scht)
                    }
                }
                
                visibleStays--;
                
                // UI neu generieren
                const containerId = currentMode === 'schengen' ? 'schengenStayEntries' : 'visaStayEntries';
                const container = document.getElementById(containerId);
                container.innerHTML = '';
                
                for (let i = 1; i <= visibleStays; i++) {
                    const deleteButton = i > 1 ? `
                        <button type="button" class="delete-stay-btn" onclick="removeStayEntry(${i})" title="Aufenthalt entfernen">
                            üóëÔ∏è
                        </button>
                    ` : '';
                    
                    const entryHTML = `
                        <div class="stay-entry">
                            <div class="stay-header">
                                <h3>üèõÔ∏è ${translations[currentLanguage].stayLabel} ${i}</h3>
                                ${deleteButton}
                            </div>
                            <div class="date-inputs">
                                <div class="input-group">
                                    <label for="${currentMode}Start${i}">${translations[currentLanguage].arrivalLabel}</label>
                                    <input type="date" id="${currentMode}Start${i}" name="${currentMode}Start${i}" onchange="calculateDays('${currentMode}', ${i})">
                                </div>
                                <div class="input-group">
                                    <label for="${currentMode}End${i}">${translations[currentLanguage].departureLabel}</label>
                                    <input type="date" id="${currentMode}End${i}" name="${currentMode}End${i}" onchange="calculateDays('${currentMode}', ${i})">
                                </div>
                            </div>
                            <div class="days-display" id="${currentMode}Days${i}"></div>
                        </div>
                    `;
                    container.innerHTML += entryHTML;
                }
                
                if (visibleStays < 5) {
                    const addButtonHTML = `
                        <div class="add-stay-section">
                            <button type="button" class="add-stay-btn" onclick="addStayEntry()">
                                ${translations[currentLanguage].addStayBtn}
                            </button>
                        </div>
                    `;
                    container.innerHTML += addButtonHTML;
                }
                
                // Angepasste Daten wiederherstellen
                setTimeout(() => {
                    restoreInputs(adjustedData);
                }, 10);
            }
        }

        function addStayEntry() {
            if (visibleStays < 5) {
                visibleStays++;
                generateStayEntries();
            }
        }

        function calculateDays(mode, entryNumber) {
            // Diese Funktion ist nicht mehr n√∂tig, da calculateStayPeriods() verwendet wird
            // Aber wir behalten sie f√ºr Kompatibilit√§t
            calculateStayPeriods();
        }

        function calculateSchengen() {
            const stayPeriods = calculateStayPeriods();
            
            if (stayPeriods.length === 0) {
                alert(translations[currentLanguage].errorNoStays);
                return;
            }
            
            const stays = stayPeriods.map(period => ({
                start: period.entryDate,
                end: period.exitDate
            }));
            
            stays.sort((a, b) => a.start.getTime() - b.start.getTime());
            
            const today = new Date();
            const lastDate = stays.reduce((latest, stay) => {
                return stay.end > latest ? stay.end : latest;
            }, today);
            
            const referenceDate = lastDate > today ? lastDate : today;
            const period180Start = new Date(referenceDate);
            period180Start.setDate(period180Start.getDate() - 180);
            
            let daysInPeriod = 0;
            const relevantStays = [];
            
            stays.forEach(stay => {
                if (stay.end >= period180Start && stay.start <= referenceDate) {
                    const effectiveStart = stay.start > period180Start ? stay.start : period180Start;
                    const effectiveEnd = stay.end < referenceDate ? stay.end : referenceDate;
                    
                    const timeDiff = effectiveEnd.getTime() - effectiveStart.getTime();
                    const days = Math.ceil(timeDiff / (1000 * 3600 * 24)) + 1;
                    
                    daysInPeriod += days;
                    relevantStays.push({
                        ...stay,
                        effectiveStart,
                        effectiveEnd,
                        days
                    });
                }
            });
            
            const remainingDays = 90 - daysInPeriod;
            const isLegal = daysInPeriod <= 90;
            
            const calculationPeriod = {
                start: period180Start,
                end: referenceDate,
                mode: 'schengen'
            };
            
            let nextEntryDate = null;
            if (!isLegal || remainingDays <= 0) {
                const sortedStays = relevantStays.sort((a, b) => a.effectiveStart.getTime() - b.effectiveStart.getTime());
                
                let cumulativeDays = 0;
                for (let stay of sortedStays) {
                    cumulativeDays += stay.days;
                    if (cumulativeDays > 90) {
                        nextEntryDate = new Date(stay.effectiveStart);
                        nextEntryDate.setDate(nextEntryDate.getDate() + 180);
                        break;
                    }
                }
                
                if (!nextEntryDate && sortedStays.length > 0) {
                    nextEntryDate = new Date(sortedStays[0].effectiveStart);
                    nextEntryDate.setDate(nextEntryDate.getDate() + 180);
                }
            }
            
            displaySchengenResults(daysInPeriod, remainingDays, isLegal, nextEntryDate, referenceDate, calculationPeriod);
        }

        function calculateVisa() {
            const visaStart = document.getElementById('visaStart').value;
            const visaEnd = document.getElementById('visaEnd').value;
            const allowedDays = parseInt(document.getElementById('allowedDays').value);
            const allowedEntries = document.getElementById('allowedEntries').value;
            
            if (!visaStart || !visaEnd || !allowedDays) {
                alert(translations[currentLanguage].errorVisaConfig);
                return;
            }
            
            const visaStartDate = new Date(visaStart);
            const visaEndDate = new Date(visaEnd);
            
            if (visaEndDate <= visaStartDate) {
                alert(translations[currentLanguage].errorVisaDates);
                return;
            }
            
            const stayPeriods = calculateStayPeriods();
            
            if (stayPeriods.length === 0) {
                alert(translations[currentLanguage].errorNoStays);
                return;
            }
            
            let totalDays = 0;
            let entriesUsed = stayPeriods.length;
            let violations = [];
            
            stayPeriods.forEach((stay, index) => {
                if (stay.entryDate < visaStartDate || stay.exitDate > visaEndDate) {
                    violations.push(`${translations[currentLanguage].stayLabel} ${index + 1}: ${translations[currentLanguage].errorStayOutsideVisa}`);
                    return;
                }
                
                totalDays += stay.days;
            });
            
            let isCompliant = true;
            
            if (allowedEntries !== 'multi' && entriesUsed > parseInt(allowedEntries)) {
                violations.push(`${translations[currentLanguage].tooManyEntries}: ${entriesUsed}/${allowedEntries}`);
                isCompliant = false;
            }
            
            if (totalDays > allowedDays) {
                violations.push(`${translations[currentLanguage].daysOverLimit}: ${totalDays}/${allowedDays}`);
                isCompliant = false;
            }
            
            displayVisaResults(totalDays, allowedDays, entriesUsed, allowedEntries, isCompliant, violations, visaStartDate, visaEndDate);
        }

        function displaySchengenResults(usedDays, remainingDays, isLegal, nextEntryDate, referenceDate, calculationPeriod) {
            calculationPeriodData = calculationPeriod;
            
            const resultsDiv = document.getElementById('results');
            const resultsList = document.getElementById('resultsList');
            
            let statusText, statusClass;
            if (isLegal && remainingDays > 0) {
                statusText = `${translations[currentLanguage].statusLegal} (${remainingDays} ${translations[currentLanguage].daysTextPlural} ${translations[currentLanguage].remaining})`;
                statusClass = 'status-legal';
            } else if (isLegal && remainingDays === 0) {
                statusText = translations[currentLanguage].statusExhausted;
                statusClass = 'status-warning';
            } else {
                statusText = translations[currentLanguage].statusViolation;
                statusClass = 'status-illegal';
            }
            
            resultsList.innerHTML = `
                <div class="result-item">
                    <span class="result-label">${translations[currentLanguage].usedDaysLabel}</span>
                    <span class="result-value">${usedDays} / 90 ${translations[currentLanguage].daysTextPlural}</span>
                </div>
                <div class="result-item">
                    <span class="result-label">${translations[currentLanguage].remainingDaysLabel}</span>
                    <span class="result-value">${Math.max(0, remainingDays)} ${translations[currentLanguage].daysTextPlural}</span>
                </div>
                <div class="result-item">
                    <span class="result-label">${translations[currentLanguage].statusLabel}</span>
                    <span class="result-value ${statusClass}">${statusText}</span>
                </div>
                <div class="result-item">
                    <span class="result-label">${translations[currentLanguage].calculationDateLabel}</span>
                    <span class="result-value">${referenceDate.toLocaleDateString(currentLanguage === 'de' ? 'de-DE' : 'en-GB')}</span>
                </div>
            `;
            
            if (nextEntryDate) {
                resultsList.innerHTML += `
                    <div class="next-entry-date">
                        ${translations[currentLanguage].nextEntryText} <strong>${nextEntryDate.toLocaleDateString(currentLanguage === 'de' ? 'de-DE' : 'en-GB')}</strong>
                    </div>
                `;
            }
            
            resultsDiv.classList.remove('hidden');
            resultsDiv.scrollIntoView({ behavior: 'smooth' });
        }

        function displayVisaResults(usedDays, allowedDays, entriesUsed, allowedEntries, isCompliant, violations, visaStart, visaEnd) {
            calculationPeriodData = {
                start: visaStart,
                end: visaEnd,
                mode: 'visa'
            };
            
            const resultsDiv = document.getElementById('results');
            const resultsList = document.getElementById('resultsList');
            
            const statusText = isCompliant ? translations[currentLanguage].statusVisaValid : translations[currentLanguage].statusVisaViolation;
            const statusClass = isCompliant ? 'status-legal' : 'status-illegal';
            const remainingDays = Math.max(0, allowedDays - usedDays);
            const entriesText = allowedEntries === 'multi' ? 'MULTI' : allowedEntries;
            
            resultsList.innerHTML = `
                <div class="result-item">
                    <span class="result-label">${translations[currentLanguage].usedDaysVisaLabel}</span>
                    <span class="result-value">${usedDays} / ${allowedDays} ${translations[currentLanguage].daysTextPlural}</span>
                </div>
                <div class="result-item">
                    <span class="result-label">${translations[currentLanguage].remainingDaysLabel}</span>
                    <span class="result-value">${remainingDays} ${translations[currentLanguage].daysTextPlural}</span>
                </div>
                <div class="result-item">
                    <span class="result-label">${translations[currentLanguage].entriesUsedLabel}</span>
                    <span class="result-value">${entriesUsed} / ${entriesText}</span>
                </div>
                <div class="result-item">
                    <span class="result-label">${translations[currentLanguage].statusLabel}</span>
                    <span class="result-value ${statusClass}">${statusText}</span>
                </div>
                <div class="result-item">
                    <span class="result-label">üóìÔ∏è ${translations[currentLanguage].visaPeriodLabel}</span>
                    <span class="result-value">${visaStart.toLocaleDateString(currentLanguage === 'de' ? 'de-DE' : 'en-GB')} - ${visaEnd.toLocaleDateString(currentLanguage === 'de' ? 'de-DE' : 'en-GB')}</span>
                </div>
            `;
            
            if (violations.length > 0) {
                resultsList.innerHTML += `
                    <div class="next-entry-date">
                        <strong>‚ö†Ô∏è ${translations[currentLanguage].violationsTitle}:</strong><br>
                        ${violations.join('<br>')}
                    </div>
                `;
            }
            
            resultsDiv.classList.remove('hidden');
            resultsDiv.scrollIntoView({ behavior: 'smooth' });
        }

        function collectEnteredStays() {
            const stayPeriods = calculateStayPeriods();
            
            return stayPeriods.map(stay => ({
                number: stay.number,
                startDate: stay.entryDate.toLocaleDateString(currentLanguage === 'de' ? 'de-DE' : 'en-GB'),
                endDate: stay.exitDate.toLocaleDateString(currentLanguage === 'de' ? 'de-DE' : 'en-GB'),
                days: stay.days
            }));
        }

        function printResults() {
            try {
                const resultsDiv = document.getElementById('results');
                const resultsList = document.getElementById('resultsList');
                
                if (!resultsDiv || !resultsList) {
                    throw new Error('No results to print');
                }
                
                const enteredStays = collectEnteredStays();
                
                const now = new Date();
                const printDate = now.toLocaleDateString(currentLanguage === 'de' ? 'de-DE' : 'en-GB') + 
                                 ' ' + now.toLocaleTimeString(currentLanguage === 'de' ? 'de-DE' : 'en-GB');
                
                const printTitle = currentMode === 'schengen' 
                    ? (currentLanguage === 'de' ? 'SCHENGEN AUFENTHALTSBERECHNUNG (90/180 Tage)' : 'SCHENGEN STAY CALCULATION (90/180 days)')
                    : (currentLanguage === 'de' ? 'VISUM AUFENTHALTSBERECHNUNG' : 'VISA STAY CALCULATION');
                
                const printHTML = createPrintHTML(printTitle, printDate, resultsList.innerHTML, enteredStays, calculationPeriodData);
                
                const printWindow = window.open('', '_blank', 'width=800,height=600,scrollbars=yes');
                
                if (printWindow) {
                    printWindow.document.write(printHTML);
                    printWindow.document.close();
                    
                    printWindow.onload = function() {
                        setTimeout(() => {
                            printWindow.print();
                            printWindow.onafterprint = function() {
                                printWindow.close();
                            };
                        }, 500);
                    };
                } else {
                    throw new Error('Popup blocked');
                }
                
            } catch (error) {
                console.error('Print error:', error);
                showTextExport();
            }
        }

        function createPrintHTML(title, date, resultsHTML, enteredStays, calculationPeriod) {
            const disclaimerText = translations[currentLanguage].disclaimer;
            const footerText = translations[currentLanguage].createdWith;
            
            const staysOverviewTitle = translations[currentLanguage].stayOverviewTitle;
            const arrivalLabel = translations[currentLanguage].arrivalLabel;
            const departureLabel = translations[currentLanguage].departureLabel;
            const daysTextPlural = translations[currentLanguage].daysTextPlural;
            
            let calculationPeriodHTML = '';
            if (calculationPeriod) {
                const periodStart = calculationPeriod.start.toLocaleDateString(currentLanguage === 'de' ? 'de-DE' : 'en-GB');
                const periodEnd = calculationPeriod.end.toLocaleDateString(currentLanguage === 'de' ? 'de-DE' : 'en-GB');
                
                let periodTitle, periodNote;
                if (calculationPeriod.mode === 'schengen') {
                    periodTitle = currentLanguage === 'de' ? 'Berechnungszeitraum (180 Tage)' : 'Calculation Period (180 days)';
                    periodNote = currentLanguage === 'de' ? 'Aufenthaltstage in diesem Zeitraum werden f√ºr die 90/180-Tage-Regel ber√ºcksichtigt.' : 'Stay days in this period are considered for the 90/180 day rule.';
                } else {
                    periodTitle = currentLanguage === 'de' ? 'Visum-G√ºltigkeitszeitraum' : 'Visa Validity Period';
                    periodNote = currentLanguage === 'de' ? 'Alle Aufenthalte m√ºssen innerhalb dieses Zeitraums liegen.' : 'All stays must be within this period.';
                }
                
                calculationPeriodHTML = `
                    <div class="calculation-period">
                        <h2>${periodTitle}</h2>
                        <div class="period-info">
                            <strong>${periodStart} ‚Üí ${periodEnd}</strong>
                            <p>${periodNote}</p>
                        </div>
                    </div>
                `;
            }
            
            let staysTableHTML = '';
            if (enteredStays.length > 0) {
                staysTableHTML = `
                    <div class="stays-overview">
                        <h2>${staysOverviewTitle}</h2>
                        <table class="stays-table">
                            <thead>
                                <tr>
                                    <th>#</th>
                                    <th>${arrivalLabel}</th>
                                    <th>${departureLabel}</th>
                                    <th>${daysTextPlural}</th>
                                </tr>
                            </thead>
                            <tbody>
                `;
                
                enteredStays.forEach(stay => {
                    staysTableHTML += `
                        <tr>
                            <td>${stay.number}</td>
                            <td>${stay.startDate}</td>
                            <td>${stay.endDate}</td>
                            <td>${stay.days}</td>
                        </tr>
                    `;
                });
                
                staysTableHTML += `
                            </tbody>
                        </table>
                    </div>
                `;
            }
            
            return `
<!DOCTYPE html>
<html lang="${currentLanguage}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${title}</title>
    <style>
        @media print {
            @page { margin: 2cm; size: A4; }
        }
        body {
            font-family: Arial, sans-serif;
            font-size: 12pt;
            line-height: 1.4;
            color: black;
            margin: 0;
            padding: 20px;
            background: white;
        }
        .header {
            text-align: center;
            border-bottom: 3px solid black;
            padding-bottom: 15px;
            margin-bottom: 30px;
        }
        .header h1 {
            font-size: 18pt;
            font-weight: bold;
            margin: 0 0 10px 0;
        }
        .header .date {
            font-size: 11pt;
            color: #666;
        }
        .calculation-period {
            background: #f0f8ff;
            border: 2px solid #4169e1;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 25px;
            page-break-inside: avoid;
        }
        .calculation-period h2 {
            font-size: 14pt;
            font-weight: bold;
            margin: 0 0 10px 0;
            color: #1e3a8a;
        }
        .period-info {
            text-align: center;
        }
        .period-info strong {
            font-size: 13pt;
            color: #1e40af;
            display: block;
            margin-bottom: 5px;
        }
        .period-info p {
            font-size: 10pt;
            color: #666;
            margin: 0;
            font-style: italic;
        }
        .stays-overview {
            margin-bottom: 30px;
            page-break-inside: avoid;
        }
        .stays-overview h2 {
            font-size: 14pt;
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            border-bottom: 2px solid #ccc;
            padding-bottom: 8px;
        }
        .stays-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        .stays-table th, .stays-table td {
            border: 1px solid #999;
            padding: 8px 12px;
            text-align: left;
        }
        .stays-table th {
            background: #f5f5f5;
            font-weight: bold;
            color: #333;
        }
        .stays-table td:first-child {
            text-align: center;
            font-weight: bold;
        }
        .stays-table td:last-child {
            text-align: center;
        }
        .result-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #ccc;
            page-break-inside: avoid;
        }
        .result-label {
            font-weight: 600;
            color: #333;
            flex: 1;
        }
        .result-value {
            font-weight: bold;
            text-align: right;
            flex: 1;
        }
        .status-legal { color: #2d5a2d; }
        .status-illegal { color: #8b0000; }
        .status-warning { color: #8b6914; }
        .next-entry-date {
            background: #f5f5f5;
            border: 1px solid #999;
            padding: 15px;
            margin: 20px 0;
            text-align: center;
            border-radius: 5px;
            page-break-inside: avoid;
        }
        .footer {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #ccc;
            font-size: 9pt;
            color: #666;
            text-align: center;
            page-break-inside: avoid;
        }
        .disclaimer {
            font-style: italic;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>${title}</h1>
        <div class="date">${translations[currentLanguage].createdOn}: ${date}</div>
    </div>
    
    ${calculationPeriodHTML}
    
    ${staysTableHTML}
    
    <div class="results">
        ${resultsHTML}
    </div>
    
    <div class="footer">
        <div class="disclaimer">${disclaimerText}</div>
        <div>${footerText} | ${translations[currentLanguage].pageInfo}</div>
    </div>
</body>
</html>`;
        }

        function showTextExport() {
            const resultsDiv = document.getElementById('results');
            const resultItems = resultsDiv.querySelectorAll('.result-item');
            
            // Aufenthalts-Daten sammeln
            const enteredStays = collectEnteredStays();
            
            let textContent = currentMode === 'schengen' 
                ? (currentLanguage === 'de' ? 'SCHENGEN AUFENTHALTSBERECHNUNG (90/180 Tage)' : 'SCHENGEN STAY CALCULATION (90/180 days)')
                : (currentLanguage === 'de' ? 'VISUM AUFENTHALTSBERECHNUNG' : 'VISA STAY CALCULATION');
            
            textContent += '\n' + '='.repeat(60) + '\n\n';
            textContent += translations[currentLanguage].createdOn + ': ' + new Date().toLocaleString() + '\n\n';
            
            // Bezugszeitraum hinzuf√ºgen
            if (calculationPeriodData) {
                const periodStart = calculationPeriodData.start.toLocaleDateString(currentLanguage === 'de' ? 'de-DE' : 'en-GB');
                const periodEnd = calculationPeriodData.end.toLocaleDateString(currentLanguage === 'de' ? 'de-DE' : 'en-GB');
                
                let periodTitle, periodNote;
                if (calculationPeriodData.mode === 'schengen') {
                    periodTitle = currentLanguage === 'de' ? 'BERECHNUNGSZEITRAUM (180 Tage)' : 'CALCULATION PERIOD (180 days)';
                    periodNote = currentLanguage === 'de' ? 'Aufenthaltstage in diesem Zeitraum werden f√ºr die 90/180-Tage-Regel ber√ºcksichtigt.' : 'Stay days in this period are considered for the 90/180 day rule.';
                } else {
                    periodTitle = currentLanguage === 'de' ? 'VISUM-G√úLTIGKEITSZEITRAUM' : 'VISA VALIDITY PERIOD';
                    periodNote = currentLanguage === 'de' ? 'Alle Aufenthalte m√ºssen innerhalb dieses Zeitraums liegen.' : 'All stays must be within this period.';
                }
                
                textContent += `${periodTitle}:\n`;
                textContent += `${periodStart} ‚Üí ${periodEnd}\n`;
                textContent += `${periodNote}\n\n`;
            }
            
            // Eingegebene Aufenthalte hinzuf√ºgen
            if (enteredStays.length > 0) {
                textContent += translations[currentLanguage].stayOverviewTitle + ':\n';
                textContent += '-'.repeat(40) + '\n';
                enteredStays.forEach(stay => {
                    textContent += `${stay.number}. ${stay.startDate} - ${stay.endDate} (${stay.days} ${translations[currentLanguage].daysTextPlural})\n`;
                });
                textContent += '\n';
            }
            
            textContent += 'BERECHNUNGSERGEBNIS:\n';
            textContent += '-'.repeat(40) + '\n';
            
            resultItems.forEach(item => {
                const label = item.querySelector('.result-label')?.textContent || '';
                const value = item.querySelector('.result-value')?.textContent || '';
                textContent += `${label}: ${value}\n`;
            });
            
            const nextEntry = resultsDiv.querySelector('.next-entry-date');
            if (nextEntry) {
                textContent += '\n' + nextEntry.textContent + '\n';
            }
            
            textContent += '\n' + '='.repeat(60) + '\n';
            textContent += translations[currentLanguage].disclaimer;
            
            // Text als Download anbieten
            const blob = new Blob([textContent], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'schengen-berechnung.txt';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            alert(currentLanguage === 'de' 
                ? 'Die Berechnung wurde als Textdatei heruntergeladen.' 
                : 'The calculation has been downloaded as a text file.');
        }

        document.addEventListener('DOMContentLoaded', function() {
            generateStayEntries();
            updatePeriodDisplay();
            
            // Initiale √úbersetzung anwenden
            const allowedDaysInput = document.getElementById('allowedDays');
            if (allowedDaysInput) {
                allowedDaysInput.placeholder = translations[currentLanguage].placeholder90;
            }
            
            // Initiale Berechnung der Aufenthaltszeiten
            calculateStayPeriods();
        });
    </script>
</body>
</html>
